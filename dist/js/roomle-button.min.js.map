{"version":3,"sources":["roomle-button.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","controllers","SettingsService_1","EventHandlerService_1","ButtonsService_1","DomBuilderService_1","PolyfillService_1","MobileRedirectService_1","MobileDetectService_1","RoomleTypeService_1","ImagesService_1","RoomleButton","settings","this","domBuilder","DomBuilderService","inject","imagesService","ImagesService","eventHandler","EventHandlerService","polyfillService","PolyfillService","mobileRedirectService","MobileRedirectService","mobileDetectService","MobileDetectService","SettingsService","init","preloadImages","_addCSS","_boot","prototype","scriptId","script","document","getElementById","head","getElementsByTagName","href","getAttribute","styleHref","replace","style","createElement","rel","media","setAttribute","appendChild","_setupClickListener","container","_this","addEventListener","handle","controllerClasses","element","body","addCSS","elementList","querySelectorAll","createPopUp","buildPopUp","instanceSelector","selector","key","hasOwnProperty","mode","controllerClass","parse","openCustomPopUp","content","parent","buildCustomPopUp","setTimeout","dispatchOpenPopUp","dispatchClick","type","id","buttonType","highlight","dispatch","ButtonsService","convertButtonTypeToEnum","getDomLinkFor","action","isHighlighted","roomleType","RoomleTypeService","convertTypeToEnum","link","generateLink","buildOptions","buildAnyway","buildLink","appendButtons","links","getLinks","forEach","execDeeplink","clickedButton","newWindow","callback","alternate","event_1","createEvent","initEvent","BUTTON_TYPE","TRIGGER","redirect","callbackUrl","getInstance","_instance","window","RoomleButtonInstance","rmlObject","Object","getPrototypeOf","exposedObject","booted","./controllers/Controllers","./services/ButtonsService","./services/DomBuilderService","./services/EventHandlerService","./services/ImagesService","./services/MobileDetectService","./services/MobileRedirectService","./services/PolyfillService","./services/RoomleTypeService","./services/SettingsService","2","Environments_1","Environment","rapi","protocol","rmlco","shortlink","button","shortId","env","Environments","TEST","location","host","defineProperty","get","envIndicator","substring","enumerable","configurable","./Environments","3","PRODUCTION","4","RoomleController_1","RoomleController","PopupController_1","PopupController","./PopupController","./RoomleController","5","__extends","d","b","__","constructor","p","create","Controller_1","_super","eventHandlerService","domBuilderService","subscribe","EVENT_TYPES","openPopup","bind","POP_UP_OPEN","simpleOpen","POP_UP_CLOSE","closePopup","$","showBackButton","back","classList","add","contains","remove","unfreezeScrolling","popupClose","freezeScrolling","linksContainer","hintContainer","innerHTML","hintText","text","preventDefault","popUp","popUpSelector","modal","popupOpen","slide","linkDom","slideMode","clickedHint","imgContainer","dom","img","imgUrl","images","querySelector","domLink","cloneNode","addShortlink","hint","newlinkDom","input","select","html","position","top_1","scrollTop","innerWidth","offsetWidth","overflowY","width","height","top","scrollTopValue","parseInt","Controller","../lib/Controller","../services/DomBuilderService","../services/EventHandlerService","../services/ImagesService","../services/SettingsService","6","idSelector","dataSelector","typeSelector","addButtons","createNoButtons","item","buttons","getButtons","../services/RoomleTypeService","7","_element","Element","getControllersByClass","instances","_instances","result","max","instance","push","beforeInstantiating","elements","afterInstantiating","root","className","exec","toString","toLocaleLowerCase","PARSE_ID_ATTRIBUTE","Math","floor","random","Date","now","8","Service","9","RoomleButton_1","mobileDetect","isIOS","Promise","RoomleButtonSettings","url","slice","lastIndexOf","onload","onerror","error","async","src","./RoomleButton","10","Service_1","EnumEx_1","availableButtons","EnumEx","getValues","ADD","AR","CONFIGURE","MARK","VISUALIZE","VR","START_NOW","convertButtonType","../lib/Service","../utils/EnumEx","11","ConsoleService","apply","arguments","log","args","_i","console","warn","12","IconsService_1","ConsoleService_1","RequestService_1","Environment_1","buttonsService","iconsService","IconsService","requestService","RequestService","elementCache","buttonsCache","shortLinkCache","waitingForShortLink","createCSS","css","string","property","buttonsCSS","containerClass","itemCSS","inlineCss","createTextNode","build","cacheKey","fragment","createDocumentFragment","li","buttonElement","buildTrigger","buttonTypeStr","icon","buildPopUpDom","closer","overlay","contentDiv","oldContent","buildAddToPlan","buildVisualize","buildConfigure","buildAR","buildMark","buildVR","buildButtons","div","containerType","ul_1","buttonsContainer","oneAdded_1","showOnlyTrigger","ar","conf","mark","vis","vr","trigger","insertBefore","firstChild","buildDeeplink","shortenId","ROOMLE_TYPE","CONFIGURATION","CONFIGURABLE_ITEM","ITEM","token","today","apiKey","tokenEncoded","toISOString","btoa","fetchJSON","config","method","headers","currentTenant","language","locale","referencedId","isAvailableLink","linkType","createDeeplinkInput","stopImmediatePropagation","createCopySvg","execCommand","copySvg","createCopy","h3","needsAppend","cachedLink","inputCached","spinner_1","then","shortLink","convertRoomleType","removeChild","textContent","translations","errors","deeplinkcreate","options","_a","_b","_c","_d","heading","svgIcon","alternate_1","os","createDeeplinkFor","../config/Environment","../controllers/PopupController","../services/RequestService","./ButtonsService","./ConsoleService","./IconsService","./MobileDetectService","./MobileRedirectService","./RoomleTypeService","./SettingsService","13","triggerCallbacks","openPopUpCallbacks","event","findSelector","depth","maxDepth","matches","parentElement","parentNode","triggerKey","callbackTrigger","callbackForType","getElement","hasAttribute","target","srcElement","roomleElement","typeElement","idElement","14","getSvg","attributes","svg","createElementNS","SVG_NS","attribute","setAttributeNS","getNode","name","buildPlanIcon","isPlus","viewBox","firstPath","thirdPath","buildAdd","buildPlanNow","buildAr","secondPath","graph","fourthPath","path","buildCopy","path1","transform","path2","path3","path4","path5","buildVr","15","ios","android","desktop","Image","16","isOSCached","isAndroidCached","isIPadCached","isSupportedMobileCached","test","navigator","userAgent","MSStream","isAndroid","isSupportedMobile","isIPad","handlePlan","typeStr","iosPlanLink","desktopLink","web","baseUrl","viewrLink","createLinkForItemOrConfiguration","isItem","iosIdentifier","webIdentifier","planId","iosLink","isConfigurableItem","handleItem","handleConfiguration","deeplink","PLAN","seperator","indexOf","17","delay","oss","storePrefix","getTime","open","handleAndroidBrowsers","appId","scheme","isAndroidMobile","regExAppleWebKit","RegExp","resultAppleWebKitRegEx","appleWebKitVersion","parseFloat","isAndroidBrowser","split","encodeURI","perfromDeepLink","clicked","timeout","data","parseHref","start","finalURI","osin","hrefParts","el","display","18","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","ownerDocument","19","fetch","resolve","reject","xhr","XMLHttpRequest","TypeError","separator","uri","encodedKey","encodeURIComponent","encodedContent","JSON","stringify","status","responseText","response","onabort","ontimeout","credentials","username","password","setRequestHeader","send","20","21","setDefault","defaultValue","toCheck","keys","keysLength","undefined","setDeeplinkTranslation","translation","androidHint","iosHint","22","getNamesAndValues","getNames","map","value","getObjValues","filter","v","k"],"mappings":"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","file":"roomle-button.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\nvar controllers = require(\"./controllers/Controllers\");\nvar SettingsService_1 = require(\"./services/SettingsService\");\nvar EventHandlerService_1 = require(\"./services/EventHandlerService\");\nvar ButtonsService_1 = require(\"./services/ButtonsService\");\nvar DomBuilderService_1 = require(\"./services/DomBuilderService\");\nvar PolyfillService_1 = require(\"./services/PolyfillService\");\nvar MobileRedirectService_1 = require(\"./services/MobileRedirectService\");\nvar MobileDetectService_1 = require(\"./services/MobileDetectService\");\nvar RoomleTypeService_1 = require(\"./services/RoomleTypeService\");\nvar ImagesService_1 = require(\"./services/ImagesService\");\nvar RoomleButton = (function () {\n    function RoomleButton(settings) {\n        this.domBuilder = DomBuilderService_1.DomBuilderService.inject();\n        this.imagesService = ImagesService_1.ImagesService.inject();\n        this.eventHandler = EventHandlerService_1.EventHandlerService.inject();\n        this.polyfillService = PolyfillService_1.PolyfillService.inject();\n        this.mobileRedirectService = MobileRedirectService_1.MobileRedirectService.inject();\n        this.mobileDetectService = MobileDetectService_1.MobileDetectService.inject();\n        SettingsService_1.SettingsService.init(settings);\n        this.imagesService.preloadImages();\n        this._addCSS();\n        this._boot();\n    }\n    ;\n    RoomleButton.prototype._addCSS = function () {\n        var scriptId = 'rml-button-lib';\n        var script = document.getElementById(scriptId);\n        if (!script) {\n            return;\n        }\n        var head = document.head || document.getElementsByTagName('head')[0];\n        var href = script.getAttribute('src');\n        var styleHref = href.replace(/\\.js/g, '.css').replace(/\\/js\\//g, '/css/');\n        var style = document.createElement('link');\n        //style.async = true;\n        style.href = styleHref;\n        style.rel = 'stylesheet';\n        style.media = 'all';\n        style.setAttribute('integrity', '###sricheck###');\n        head.appendChild(style);\n    };\n    RoomleButton.prototype._setupClickListener = function (container) {\n        var _this = this;\n        container.addEventListener('click', function (e) { return _this.eventHandler.handle(e); });\n    };\n    RoomleButton.prototype._boot = function () {\n        var controllerClasses = controllers;\n        var element = document.body;\n        this.domBuilder.addCSS();\n        if (SettingsService_1.SettingsService.settings.container) {\n            var elementList = document.body.querySelectorAll(SettingsService_1.SettingsService.settings.container);\n            if (elementList.length) {\n                element = elementList[0];\n            }\n        }\n        if (SettingsService_1.SettingsService.settings.createPopUp) {\n            this.domBuilder.buildPopUp(element);\n        }\n        this._setupClickListener(element);\n        var instanceSelector = SettingsService_1.SettingsService.settings.selector; // ? this.settings.selector : '[data-roomle-id]';\n        for (var key in controllerClasses) {\n            if (controllerClasses.hasOwnProperty(key)) {\n                if (key === 'RoomleController' && SettingsService_1.SettingsService.settings.mode === 'lib') {\n                    continue;\n                }\n                var controllerClass = controllerClasses[key];\n                if (typeof controllerClass.parse === 'function') {\n                    controllerClass.parse(instanceSelector, element);\n                }\n            }\n        }\n    };\n    RoomleButton.prototype.openCustomPopUp = function (e, content, parent) {\n        var _this = this;\n        this.domBuilder.buildCustomPopUp(content, parent);\n        setTimeout(function () {\n            _this.eventHandler.dispatchOpenPopUp(e);\n        }, 1);\n    };\n    RoomleButton.prototype.dispatchClick = function (e, type, id, buttonType, highlight) {\n        if (highlight === void 0) { highlight = null; }\n        this.eventHandler.dispatch(e, type, id, ButtonsService_1.ButtonsService.convertButtonTypeToEnum(buttonType), highlight);\n    };\n    RoomleButton.prototype.getDomLinkFor = function (action, id, type, isHighlighted) {\n        if (isHighlighted === void 0) { isHighlighted = false; }\n        var roomleType = RoomleTypeService_1.RoomleTypeService.convertTypeToEnum(type);\n        var buttonType = ButtonsService_1.ButtonsService.convertButtonTypeToEnum(action);\n        var link = this.mobileDetectService.generateLink(id, roomleType, buttonType);\n        var buildOptions = { isHighlighted: isHighlighted, buildAnyway: true };\n        return this.domBuilder.buildLink(link, buildOptions);\n    };\n    RoomleButton.prototype.appendButtons = function (container, id, type) {\n        var _this = this;\n        var links = this.getLinks(id, type);\n        links.forEach(function (link) {\n            container.appendChild(_this.domBuilder.buildLink(link));\n        });\n    };\n    RoomleButton.prototype.execDeeplink = function (id, type, clickedButton, newWindow, callback) {\n        if (newWindow === void 0) { newWindow = false; }\n        if (callback === void 0) { callback = null; }\n        var roomleType = RoomleTypeService_1.RoomleTypeService.convertTypeToEnum(type);\n        var buttonType = ButtonsService_1.ButtonsService.convertButtonTypeToEnum(clickedButton);\n        var link = this.mobileDetectService.generateLink(id, roomleType, buttonType);\n        if (link.alternate) {\n            var event_1 = document.createEvent('Event');\n            event_1.initEvent('execDeeplink', true, true);\n            this.eventHandler.dispatch(event_1, type, id, ButtonsService_1.BUTTON_TYPE.TRIGGER, clickedButton, newWindow);\n        }\n        else {\n            this.mobileRedirectService.redirect(link, newWindow, callback);\n        }\n    };\n    RoomleButton.prototype.getLinks = function (id, type, callbackUrl) {\n        if (callbackUrl === void 0) { callbackUrl = null; }\n        return this.mobileDetectService.getLinks(id, RoomleTypeService_1.RoomleTypeService.convertTypeToEnum(type), callbackUrl);\n    };\n    RoomleButton.getInstance = function (settings) {\n        if (!(this._instance instanceof RoomleButton)) {\n            this._instance = new this(settings);\n        }\n        if (!window.RoomleButtonInstance) {\n            var rmlObject = Object.getPrototypeOf(this._instance);\n            var exposedObject = {};\n            for (var key in rmlObject) {\n                if (key && rmlObject.hasOwnProperty(key) && key[0] !== '_') {\n                    exposedObject[key] = rmlObject[key];\n                }\n            }\n            window.RoomleButtonInstance = exposedObject;\n            SettingsService_1.SettingsService.settings.callback.booted();\n        }\n        return this._instance;\n    };\n    return RoomleButton;\n}());\nexports.RoomleButton = RoomleButton;\n\n},{\"./controllers/Controllers\":4,\"./services/ButtonsService\":10,\"./services/DomBuilderService\":12,\"./services/EventHandlerService\":13,\"./services/ImagesService\":15,\"./services/MobileDetectService\":16,\"./services/MobileRedirectService\":17,\"./services/PolyfillService\":18,\"./services/RoomleTypeService\":20,\"./services/SettingsService\":21}],2:[function(require,module,exports){\n\"use strict\";\nvar Environments_1 = require(\"./Environments\");\nvar Environment = (function () {\n    function Environment() {\n    }\n    Environment.settings = function () {\n        var settings = {\n            rapi: 'api.test.roomle.com/v2',\n            protocol: 'https://',\n            rmlco: '',\n            shortlink: function (type, id, button, shortId) {\n                if (shortId === void 0) { shortId = null; }\n                if (Environment.env !== Environments_1.Environments.TEST && !!shortId) {\n                    return 'http://rml.co/' + shortId + '/' + button;\n                }\n                return window.location.host + '/deeplink?id=' + id + '&type=' + type + '&button=' + button;\n            }\n        };\n        if (Environment.env !== Environments_1.Environments.TEST) {\n            settings.rapi = 'api.roomle.com/v2';\n        }\n        settings.rmlco = settings.protocol + settings.rapi + '/shortIds';\n        return settings;\n    };\n    Object.defineProperty(Environment, \"env\", {\n        get: function () {\n            return this.envIndicator.substring(3, this.envIndicator.length - 3);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Environment, \"config\", {\n        get: function () {\n            return Environment.settings();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Environment;\n}());\nEnvironment.envIndicator = '###production###';\nexports.Environment = Environment;\n\n},{\"./Environments\":3}],3:[function(require,module,exports){\n\"use strict\";\nvar Environments = (function () {\n    function Environments() {\n    }\n    return Environments;\n}());\nEnvironments.PRODUCTION = 'production';\nEnvironments.TEST = 'test';\nexports.Environments = Environments;\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\nvar RoomleController_1 = require(\"./RoomleController\");\nexports.RoomleController = RoomleController_1.RoomleController;\nvar PopupController_1 = require(\"./PopupController\");\nexports.PopupController = PopupController_1.PopupController;\n\n},{\"./PopupController\":5,\"./RoomleController\":6}],5:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Controller_1 = require(\"../lib/Controller\");\nvar SettingsService_1 = require(\"../services/SettingsService\");\nvar EventHandlerService_1 = require(\"../services/EventHandlerService\");\nvar DomBuilderService_1 = require(\"../services/DomBuilderService\");\nvar ImagesService_1 = require(\"../services/ImagesService\");\nvar PopupController = (function (_super) {\n    __extends(PopupController, _super);\n    function PopupController(element) {\n        var _this = _super.call(this, element) || this;\n        _this.eventHandlerService = EventHandlerService_1.EventHandlerService.inject();\n        _this.domBuilderService = DomBuilderService_1.DomBuilderService.inject();\n        _this.imagesService = ImagesService_1.ImagesService.inject();\n        if (!SettingsService_1.SettingsService.settings.createPopUp) {\n            return _this;\n        }\n        _this.eventHandlerService.subscribe(EventHandlerService_1.EVENT_TYPES.TRIGGER, _this.openPopup.bind(_this));\n        _this.eventHandlerService.subscribe(EventHandlerService_1.EVENT_TYPES.POP_UP_OPEN, _this.simpleOpen.bind(_this));\n        _this.eventHandlerService.subscribe(EventHandlerService_1.EVENT_TYPES.POP_UP_CLOSE, _this.closePopup.bind(_this));\n        _this.$('.rml-md-overlay')[0].addEventListener('click', function () { return _this.closePopup(); });\n        _this.$('.rml-popup--close')[0].addEventListener('click', function () { return _this.closePopup(); });\n        if (SettingsService_1.SettingsService.settings.showBackButton) {\n            _this.$('.rml-popup--back')[0].addEventListener('click', function () { return _this.back(); });\n        }\n        else {\n            _this.$('.rml-popup--back')[0].classList.add('rml-popup--back__hide');\n        }\n        return _this;\n        //this.roomleButtonService.addRoomleButton(this.triggerClicked.bind(this));\n    }\n    PopupController.prototype.closePopup = function () {\n        var classList = this.$('.rml-popup')[0].classList;\n        if (classList.contains('rml-md-show')) {\n            classList.remove('rml-md-show');\n            var back = this.$('.rml-popup--back')[0];\n            back.classList.remove('rml-popup--back__show');\n            this.unfreezeScrolling();\n            if (typeof SettingsService_1.SettingsService.settings.callback.popupClose === 'function') {\n                var id = (this.id) ? this.id : 'CUSTOM';\n                var type = (this.type) ? this.type : 'CUSTOM';\n                SettingsService_1.SettingsService.settings.callback.popupClose(id, type);\n            }\n        }\n        else {\n            classList.add('rml-md-show');\n            this.freezeScrolling();\n        }\n    };\n    PopupController.prototype.back = function () {\n        var linksContainer = this.$('.rml-deeplink--slider')[0];\n        linksContainer.classList.remove('rml-deeplink__hint');\n        var hintContainer = this.$('.rml-deeplink__hint-container')[0];\n        hintContainer.innerHTML = '';\n        var back = this.$('.rml-popup--back')[0];\n        back.classList.remove('rml-popup--back__show');\n        var hintText = this.$('.rml-deeplink--hint');\n        if (hintText.length) {\n            var text = hintText[0];\n            text.classList.remove('rml-hint__show');\n        }\n    };\n    PopupController.prototype.simpleOpen = function (e, id, type) {\n        e.preventDefault();\n        this.id = id;\n        this.type = type;\n        var popUp = document.querySelectorAll('[' + SettingsService_1.SettingsService.settings.popUpSelector + ']');\n        var modal = popUp[0].querySelectorAll('.rml-md-modal');\n        if (modal[0].classList.contains('rml-md-show')) {\n            modal[0].classList.remove('rml-md-show');\n        }\n        else {\n            modal[0].classList.add('rml-md-show');\n        }\n        this.freezeScrolling();\n        if (typeof SettingsService_1.SettingsService.settings.callback.popupOpen === 'function') {\n            SettingsService_1.SettingsService.settings.callback.popupOpen((id) ? id : 'CUSTOM', (type) ? type : 'CUSTOM');\n        }\n        return modal[0];\n    };\n    PopupController.prototype.openPopup = function (e, id, type, links, highlight) {\n        var _this = this;\n        var modal = this.simpleOpen(e, id, type);\n        var container = modal.querySelectorAll('.rml-generated-content');\n        container[0].innerHTML = '';\n        var linksContainer = document.createElement('div');\n        linksContainer.classList.add('rml-deeplink--slider');\n        linksContainer.classList.add('rml-deeplink--links');\n        var slide = document.createElement('div');\n        slide.classList.add('rml-deeplink--slide');\n        slide.classList.add('rml-deeplink--overview');\n        var alternate = document.createElement('div');\n        alternate.classList.add('rml-deeplink--slide');\n        alternate.classList.add('rml-deeplink--alternate');\n        links.forEach(function (link) {\n            var isHighlighted = link.type === highlight;\n            var linkDom = _this.domBuilderService.buildLink(link, {\n                isHighlighted: isHighlighted,\n                slideMode: true,\n                clickedHint: function () {\n                    alternate.innerHTML = '';\n                    var hintContainer = document.createElement('div');\n                    hintContainer.classList.add('rml-deeplink__hint-container');\n                    var imgContainer = document.createElement('div');\n                    var dom = document.createElement('div');\n                    imgContainer.classList.add('rml-deeplink__hint-img');\n                    dom.classList.add('rml-deeplink__hint-link');\n                    var img = document.createElement('img');\n                    var imgUrl = _this.imagesService.images[link.alternate];\n                    img.setAttribute('src', imgUrl);\n                    imgContainer.appendChild(img);\n                    hintContainer.appendChild(imgContainer);\n                    var back = document.querySelector('.rml-popup--back');\n                    if (SettingsService_1.SettingsService.settings.showBackButton) {\n                        back.classList.add('rml-popup--back__show');\n                    }\n                    var domLink = linkDom.cloneNode(true);\n                    dom.appendChild(domLink);\n                    _this.domBuilderService.addShortlink(dom, link.roomleType, link.type, link.id);\n                    hintContainer.appendChild(dom);\n                    alternate.appendChild(hintContainer);\n                    if (linksContainer.classList.contains('rml-deeplink__hint')) {\n                        linksContainer.classList.remove('rml-deeplink__hint');\n                    }\n                    else {\n                        linksContainer.classList.add('rml-deeplink__hint');\n                    }\n                    var hint = dom.querySelector('.rml-deeplink--hint');\n                    _this.domBuilderService.addShortlink(dom, link.roomleType, link.type, link.id);\n                    hint.classList.add('rml-hint__show');\n                    var newlinkDom = alternate.querySelector('.rml-deeplink--row');\n                    newlinkDom.addEventListener('click', function (e) {\n                        e.preventDefault();\n                        var input = dom.querySelector('input');\n                        input.select();\n                        return false;\n                    });\n                    if (typeof SettingsService_1.SettingsService.settings.callback.clickedHint === 'function') {\n                        SettingsService_1.SettingsService.settings.callback.clickedHint(link.id, link.roomleType, link.type);\n                    }\n                }\n            });\n            if (!linkDom) {\n                return;\n            }\n            slide.appendChild(linkDom);\n        });\n        linksContainer.appendChild(slide);\n        linksContainer.appendChild(alternate);\n        container[0].appendChild(linksContainer);\n    };\n    PopupController.prototype.freezeScrolling = function () {\n        var html = document.querySelector('html');\n        var body = document.body;\n        if (html.style.position !== 'fixed') {\n            var top_1 = html.scrollTop ? html.scrollTop : body.scrollTop;\n            if (window.innerWidth > html.offsetWidth) {\n                html.style.overflowY = 'scroll';\n            }\n            html.style.width = '100%';\n            html.style.height = '100%';\n            html.style.position = 'fixed';\n            html.style.top = (-top_1) + 'px';\n        }\n    };\n    PopupController.prototype.unfreezeScrolling = function () {\n        var html = document.querySelector('html');\n        var body = document.body;\n        if (html.style.position === 'fixed') {\n            html.style.position = 'static';\n            var scrollTopValue = -parseInt(html.style.top, 10);\n            html.scrollTop = scrollTopValue;\n            body.scrollTop = scrollTopValue;\n            html.style.position = '';\n            html.style.width = '';\n            html.style.height = '';\n            html.style.top = '';\n            html.style.overflowY = '';\n        }\n    };\n    return PopupController;\n}(Controller_1.Controller));\nPopupController.selector = '[data-rml-deeplink-popup-container]';\nexports.PopupController = PopupController;\n\n},{\"../lib/Controller\":7,\"../services/DomBuilderService\":12,\"../services/EventHandlerService\":13,\"../services/ImagesService\":15,\"../services/SettingsService\":21}],6:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Controller_1 = require(\"../lib/Controller\");\nvar DomBuilderService_1 = require(\"../services/DomBuilderService\");\nvar RoomleTypeService_1 = require(\"../services/RoomleTypeService\");\nvar SettingsService_1 = require(\"../services/SettingsService\");\nvar RoomleController = (function (_super) {\n    __extends(RoomleController, _super);\n    function RoomleController(element) {\n        var _this = _super.call(this, element) || this;\n        _this.id = null;\n        _this.type = null;\n        _this.domBuilder = DomBuilderService_1.DomBuilderService.inject();\n        if (element) {\n            var idSelector = SettingsService_1.SettingsService.settings.dataSelector.id;\n            var typeSelector = SettingsService_1.SettingsService.settings.dataSelector.type;\n            _this.id = element.getAttribute(idSelector);\n            _this.type = RoomleTypeService_1.RoomleTypeService.convertTypeToEnum(element.getAttribute(typeSelector));\n            if (_this.type !== null && _this.id) {\n                _this.addButtons(_this.type);\n            }\n        }\n        return _this;\n    }\n    RoomleController.prototype.addButtons = function (type) {\n        if (SettingsService_1.SettingsService.settings.createNoButtons) {\n            return;\n        }\n        var item = this.$();\n        if (!item) {\n            return;\n        }\n        var buttons = this.domBuilder.getButtons(type);\n        item.appendChild(buttons);\n    };\n    return RoomleController;\n}(Controller_1.Controller));\nexports.RoomleController = RoomleController;\n\n},{\"../lib/Controller\":7,\"../services/DomBuilderService\":12,\"../services/RoomleTypeService\":20,\"../services/SettingsService\":21}],7:[function(require,module,exports){\n\"use strict\";\n/**\n * Generic controller class to entcapsulate the parsing\n * and other generic stuff\n *\n * @export\n * @class Controller\n */\nvar Controller = (function () {\n    /**\n     * Creates an instance of a Controller.\n     *\n     * @param {Element} root The element where the controller has been applied\n     */\n    function Controller(element) {\n        this._element = element;\n    }\n    Controller.prototype.$ = function (selector) {\n        if (!(this._element instanceof Element)) {\n            throw new Error('This controller has no element!');\n        }\n        return selector ? this._element.querySelectorAll(selector) : this._element;\n    };\n    Controller.prototype.getControllersByClass = function (controllerClass) {\n        var instances = Controller._instances;\n        var result = [];\n        for (var i = 0, max = instances.length; i < max; i++) {\n            var instance = instances[i];\n            if (instance instanceof controllerClass) {\n                result.push(instance);\n            }\n        }\n        return result;\n    };\n    /**\n     * Hook for running code before the controller is instantiated\n     *\n     * @static\n     * @param {NodeListOf<Element>} elements List of elements where the controller will be applied\n     */\n    Controller.beforeInstantiating = function (elements) {\n    };\n    /**\n     * Hook for running code after the controller has been instantiated.\n     *\n     * @static\n     * @param {NodeListOf<Element>} elements List of elements where the controller has been applied\n     * @param {Array<Controller>} instances List of controller instances created\n     */\n    Controller.afterInstantiating = function (elements, instances) {\n    };\n    /**\n     * Look for elements with a specific selector and creates an instance for\n     * every element.\n     *\n     * @static\n     * @param {string} selector Dom selector\n     * @param {Element} [root=document.body] Starting element for parsing\n     */\n    Controller.parse = function (selector, root) {\n        if (root === void 0) { root = document.body; }\n        if (typeof this.selector === 'string' && this.selector.length) {\n            selector = this.selector;\n        }\n        else if (!selector) {\n            return;\n        }\n        var elements = root.querySelectorAll(selector);\n        this.beforeInstantiating(elements);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var className = /^function\\s+([\\w\\$]+)\\s*\\(/.exec(this.toString())[1];\n            className = className.toLocaleLowerCase();\n            if (element.getAttribute(Controller.PARSE_ID_ATTRIBUTE + '-' + className)) {\n                continue;\n            }\n            element.setAttribute(Controller.PARSE_ID_ATTRIBUTE + '-' + className, Math.floor(Math.random() * 10 + 1) * Date.now() + '');\n            Controller._instances.push(new this(element));\n        }\n        this.afterInstantiating(elements, Controller._instances);\n    };\n    return Controller;\n}());\n/**\n * Instances of the Controller\n *\n * @static\n * @type {Array<Controller>}\n */\nController._instances = [];\n/**\n * HTML attribute to mark elements which are already parsed\n *\n * @static\n */\nController.PARSE_ID_ATTRIBUTE = 'data-parse-id';\nexports.Controller = Controller;\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\n/**\n * Simple Singelton Service implementation\n * which will be extended by the other Services like\n * - DataSerivce\n * - TemplateService\n * - ...\n *\n * @export\n * @class Service\n */\nvar Service = (function () {\n    function Service() {\n    }\n    /**\n     * Returns the current instance or creates a new\n     * one if there isn't already an instance available.\n     *\n     * @static\n     * @returns {Service} Instance of the current Service\n     */\n    Service.getInstance = function () {\n        if (!(this._instance instanceof Service)) {\n            this._instance = new this();\n        }\n        return this._instance;\n    };\n    /**\n     * Naming Wrapper for the getInstance() function\n     * because inject sounds cooler.\n     *\n     * @static\n     * @returns {Service} Instance of the current Service\n     */\n    Service.inject = function () {\n        return this.getInstance();\n    };\n    return Service;\n}());\nexports.Service = Service;\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\nvar MobileDetectService_1 = require(\"./services/MobileDetectService\");\nvar RoomleButton_1 = require(\"./RoomleButton\");\nvar mobileDetect = MobileDetectService_1.MobileDetectService.inject();\nmobileDetect.isIOS();\nif (!window.Promise) {\n    var scriptId = 'rml-button-lib';\n    var script = document.getElementById(scriptId);\n    var href = script.getAttribute('src');\n    var element = document.createElement('script');\n    var url = href.slice(0, href.lastIndexOf('/'));\n    element.onload = function () { return RoomleButton_1.RoomleButton.getInstance(window.RoomleButtonSettings); };\n    element.onerror = function (error) { return RoomleButton_1.RoomleButton.getInstance(window.RoomleButtonSettings); };\n    element.async = true;\n    element.src = url + '/es6-promise.min.js';\n    element.setAttribute('type', 'text/javascript');\n    document.body.appendChild(element);\n}\nelse {\n    RoomleButton_1.RoomleButton.getInstance(window.RoomleButtonSettings);\n}\n\n},{\"./RoomleButton\":1,\"./services/MobileDetectService\":16}],10:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar EnumEx_1 = require(\"../utils/EnumEx\");\nvar BUTTON_TYPE;\n(function (BUTTON_TYPE) {\n    BUTTON_TYPE[BUTTON_TYPE[\"TRIGGER\"] = 0] = \"TRIGGER\";\n    BUTTON_TYPE[BUTTON_TYPE[\"ADD\"] = 1] = \"ADD\";\n    BUTTON_TYPE[BUTTON_TYPE[\"VISUALIZE\"] = 2] = \"VISUALIZE\";\n    BUTTON_TYPE[BUTTON_TYPE[\"CONFIGURE\"] = 3] = \"CONFIGURE\";\n    BUTTON_TYPE[BUTTON_TYPE[\"AR\"] = 4] = \"AR\";\n    BUTTON_TYPE[BUTTON_TYPE[\"MARK\"] = 5] = \"MARK\";\n    BUTTON_TYPE[BUTTON_TYPE[\"START_NOW\"] = 6] = \"START_NOW\";\n    BUTTON_TYPE[BUTTON_TYPE[\"VR\"] = 7] = \"VR\";\n})(BUTTON_TYPE = exports.BUTTON_TYPE || (exports.BUTTON_TYPE = {}));\nvar ButtonsService = (function (_super) {\n    __extends(ButtonsService, _super);\n    function ButtonsService() {\n        var _this = _super.call(this) || this;\n        _this.availableButtons = EnumEx_1.EnumEx.getValues(BUTTON_TYPE);\n        return _this;\n    }\n    ButtonsService.convertButtonTypeToEnum = function (buttonType) {\n        if (buttonType === 'trigger') {\n            return BUTTON_TYPE.TRIGGER;\n        }\n        if (buttonType === 'add') {\n            return BUTTON_TYPE.ADD;\n        }\n        if (buttonType === 'ar') {\n            return BUTTON_TYPE.AR;\n        }\n        if (buttonType === 'configure') {\n            return BUTTON_TYPE.CONFIGURE;\n        }\n        if (buttonType === 'mark') {\n            return BUTTON_TYPE.MARK;\n        }\n        if (buttonType === 'visualize') {\n            return BUTTON_TYPE.VISUALIZE;\n        }\n        if (buttonType === 'vr') {\n            return BUTTON_TYPE.VR;\n        }\n        if (buttonType === 'start_now') {\n            return BUTTON_TYPE.START_NOW;\n        }\n    };\n    // USED TO DEFINE HOOKS FOR OUTSIDE TS WORLD. AR IS NICER THAN \"0\"\n    ButtonsService.convertButtonType = function (buttonType) {\n        if (buttonType === BUTTON_TYPE.TRIGGER) {\n            return 'trigger';\n        }\n        if (buttonType === BUTTON_TYPE.ADD) {\n            return 'add';\n        }\n        if (buttonType === BUTTON_TYPE.AR) {\n            return 'ar';\n        }\n        if (buttonType === BUTTON_TYPE.CONFIGURE) {\n            return 'configure';\n        }\n        if (buttonType === BUTTON_TYPE.MARK) {\n            return 'mark';\n        }\n        if (buttonType === BUTTON_TYPE.VISUALIZE) {\n            return 'visualize';\n        }\n        if (buttonType === BUTTON_TYPE.VR) {\n            return 'vr';\n        }\n        if (buttonType === BUTTON_TYPE.START_NOW) {\n            return 'start_now';\n        }\n    };\n    return ButtonsService;\n}(Service_1.Service));\nexports.ButtonsService = ButtonsService;\n\n},{\"../lib/Service\":8,\"../utils/EnumEx\":22}],11:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar ConsoleService = (function (_super) {\n    __extends(ConsoleService, _super);\n    function ConsoleService() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ConsoleService.log = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        console.log.apply(console, args);\n    };\n    ConsoleService.warn = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        console.warn.apply(console, args);\n    };\n    ConsoleService.error = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        console.error.apply(console, args);\n    };\n    return ConsoleService;\n}(Service_1.Service));\nexports.ConsoleService = ConsoleService;\n\n},{\"../lib/Service\":8}],12:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar MobileDetectService_1 = require(\"./MobileDetectService\");\nvar SettingsService_1 = require(\"./SettingsService\");\nvar ButtonsService_1 = require(\"./ButtonsService\");\nvar RoomleTypeService_1 = require(\"./RoomleTypeService\");\nvar IconsService_1 = require(\"./IconsService\");\nvar ConsoleService_1 = require(\"./ConsoleService\");\nvar MobileRedirectService_1 = require(\"./MobileRedirectService\");\nvar PopupController_1 = require(\"../controllers/PopupController\");\nvar RequestService_1 = require(\"../services/RequestService\");\nvar Environment_1 = require(\"../config/Environment\");\nvar DomBuilderService = (function (_super) {\n    __extends(DomBuilderService, _super);\n    function DomBuilderService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.mobileDetect = MobileDetectService_1.MobileDetectService.inject();\n        _this.buttonsService = ButtonsService_1.ButtonsService.inject();\n        _this.iconsService = IconsService_1.IconsService.inject();\n        _this.mobileRedirectService = MobileRedirectService_1.MobileRedirectService.inject();\n        _this.requestService = RequestService_1.RequestService.inject();\n        _this.elementCache = {};\n        _this.buttonsCache = {};\n        _this.shortLinkCache = {};\n        _this.waitingForShortLink = false;\n        return _this;\n    }\n    DomBuilderService.prototype.createCSS = function (css) {\n        var string = '';\n        for (var property in css) {\n            if (css.hasOwnProperty(property)) {\n                string += property + ':' + css[property] + ';';\n            }\n        }\n        return string;\n    };\n    DomBuilderService.prototype.addCSS = function () {\n        if (SettingsService_1.SettingsService.settings.createNoButtons) {\n            return;\n        }\n        var buttonsCSS = this.createCSS(SettingsService_1.SettingsService.settings.css.buttons);\n        buttonsCSS = '.' + SettingsService_1.SettingsService.settings.html.containerClass + '{' + buttonsCSS + 'visibility: hidden;}';\n        var itemCSS = this.createCSS(SettingsService_1.SettingsService.settings.css.item);\n        itemCSS = SettingsService_1.SettingsService.settings.selector + '{' + itemCSS + '}';\n        var inlineCss = '.rml-md-modal{visibility:hidden;}';\n        var css = buttonsCSS + itemCSS + inlineCss;\n        var head = document.head || document.getElementsByTagName('head')[0];\n        var style = document.createElement('style');\n        style.type = 'text/css';\n        style.appendChild(document.createTextNode(css));\n        head.appendChild(style);\n    };\n    DomBuilderService.prototype.build = function (cacheKey, content) {\n        if (!this.elementCache[cacheKey]) {\n            var fragment = document.createDocumentFragment();\n            var li = document.createElement(SettingsService_1.SettingsService.settings.html.buttonElement);\n            var buttonType = ButtonsService_1.ButtonsService.convertButtonType(cacheKey);\n            li.setAttribute(SettingsService_1.SettingsService.settings.dataSelector.action, buttonType);\n            fragment.appendChild(li);\n            this.elementCache[cacheKey] = fragment;\n        }\n        return this.elementCache[cacheKey].cloneNode(true);\n    };\n    DomBuilderService.prototype.buildTrigger = function () {\n        var cacheKey = ButtonsService_1.BUTTON_TYPE.TRIGGER;\n        var buttonTypeStr = ButtonsService_1.ButtonsService.convertButtonType(cacheKey);\n        if (!this.elementCache[cacheKey]) {\n            var fragment = document.createDocumentFragment();\n            var li = document.createElement(SettingsService_1.SettingsService.settings.html.buttonElement);\n            li.setAttribute(SettingsService_1.SettingsService.settings.dataSelector.action, buttonTypeStr);\n            var icon = this.iconsService.create(buttonTypeStr);\n            //let contentNode = document.createTextNode(content);\n            //li.appendChild(contentNode);\n            li.appendChild(icon);\n            fragment.appendChild(li);\n            this.elementCache[cacheKey] = fragment;\n        }\n        return this.elementCache[cacheKey].cloneNode(true);\n    };\n    DomBuilderService.prototype.buildPopUpDom = function () {\n        var popUp = document.body.querySelectorAll('[data-rml-deeplink-popup-container]');\n        if (popUp && popUp.length > 0) {\n            return popUp[0];\n        }\n        var container = document.createElement('div');\n        container.setAttribute('data-rml-deeplink-popup-container', '');\n        container.classList.add('rml-btn');\n        var modal = document.createElement('div');\n        modal.classList.add('rml-md-modal');\n        modal.classList.add('rml-popup');\n        modal.classList.add('rml-md-effect-1');\n        modal.setAttribute('data-rml-deeplink-popup', '');\n        var content = document.createElement('div');\n        content.classList.add('rml-md-content');\n        var closer = document.createElement('div');\n        closer.classList.add('rml-popup--close');\n        var back = document.createElement('div');\n        back.classList.add('rml-popup--back');\n        var links = document.createElement('div');\n        links.classList.add('rml-generated-content');\n        var overlay = document.createElement('div');\n        overlay.classList.add('rml-md-overlay');\n        content.appendChild(closer);\n        content.appendChild(back);\n        content.appendChild(links);\n        modal.appendChild(content);\n        container.appendChild(modal);\n        container.appendChild(overlay);\n        return container;\n    };\n    DomBuilderService.prototype.buildCustomPopUp = function (content, parent) {\n        if (parent === void 0) { parent = document.body; }\n        var container = this.buildPopUpDom();\n        var contentDiv = container.querySelectorAll('.rml-md-content')[0];\n        var oldContent = contentDiv.querySelector('.rml-generated-content');\n        oldContent.innerHTML = '';\n        if (content) {\n            oldContent.appendChild(content);\n        }\n        var popUp = document.body.querySelectorAll('[data-rml-deeplink-popup-container]');\n        if (!popUp || popUp.length === 0) {\n            parent.appendChild(container);\n            var instanceSelector = SettingsService_1.SettingsService.settings.selector;\n            var element = document.body;\n            PopupController_1.PopupController.parse(instanceSelector, element);\n        }\n    };\n    DomBuilderService.prototype.buildPopUp = function (parent) {\n        if (parent === void 0) { parent = document.body; }\n        var container = this.buildPopUpDom();\n        parent.appendChild(container);\n    };\n    DomBuilderService.prototype.buildAddToPlan = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.ADD, 'Plan');\n    };\n    DomBuilderService.prototype.buildVisualize = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.VISUALIZE, 'Visualize');\n    };\n    DomBuilderService.prototype.buildConfigure = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.CONFIGURE, 'Configure');\n    };\n    DomBuilderService.prototype.buildAR = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.AR, 'Augmented Reality');\n    };\n    DomBuilderService.prototype.buildMark = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.MARK, 'Mark');\n    };\n    DomBuilderService.prototype.buildVR = function () {\n        return this.build(ButtonsService_1.BUTTON_TYPE.VR, 'Virtual Reality');\n    };\n    DomBuilderService.prototype.buildButtons = function (type) {\n        var _this = this;\n        var cacheKey = '';\n        this.buttonsService.availableButtons.forEach(function (buttonType) {\n            if (_this.mobileDetect.generateLink('', type, buttonType)) {\n                cacheKey += buttonType;\n            }\n        });\n        if (!this.buttonsCache[cacheKey]) {\n            var fragment = document.createDocumentFragment();\n            var div = document.createElement(SettingsService_1.SettingsService.settings.html.containerType);\n            div.classList.add(SettingsService_1.SettingsService.settings.html.containerClass);\n            var ul_1 = document.createElement(SettingsService_1.SettingsService.settings.html.buttonsContainer);\n            var oneAdded_1 = false;\n            this.buttonsService.availableButtons.forEach(function (buttonType) {\n                var link = _this.mobileDetect.generateLink('', type, buttonType);\n                if (!link) {\n                    return;\n                }\n                if (SettingsService_1.SettingsService.settings.showOnlyTrigger) {\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.ADD) {\n                    var add = _this.buildAddToPlan();\n                    ul_1.appendChild(add);\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.AR) {\n                    var ar = _this.buildAR();\n                    ul_1.appendChild(ar);\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.CONFIGURE) {\n                    var conf = _this.buildConfigure();\n                    ul_1.appendChild(conf);\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.MARK) {\n                    var mark = _this.buildMark();\n                    ul_1.appendChild(mark);\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.VISUALIZE) {\n                    var vis = _this.buildVisualize();\n                    ul_1.appendChild(vis);\n                    oneAdded_1 = true;\n                    return;\n                }\n                if (buttonType === ButtonsService_1.BUTTON_TYPE.VR) {\n                    var vr = _this.buildVR();\n                    ul_1.appendChild(vr);\n                    oneAdded_1 = true;\n                    return;\n                }\n                ConsoleService_1.ConsoleService.error('ButtonType \"' + buttonType + '\" unknown');\n            });\n            if (oneAdded_1) {\n                var trigger = this.buildTrigger();\n                ul_1.insertBefore(trigger, ul_1.firstChild);\n                div.appendChild(ul_1);\n            }\n            fragment.appendChild(div);\n            this.buttonsCache[cacheKey] = fragment;\n        }\n        return this.buttonsCache[cacheKey].cloneNode(true);\n    };\n    DomBuilderService.prototype.getButtons = function (type) {\n        return this.buildButtons(type);\n    };\n    DomBuilderService.prototype.buildDeeplink = function (type, id) {\n        var shortenId = 1;\n        if (type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURATION) {\n            shortenId = 3;\n        }\n        if (type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURABLE_ITEM || type === RoomleTypeService_1.ROOMLE_TYPE.ITEM) {\n            shortenId = 4;\n        }\n        var token = 'anonymous';\n        var today = new Date();\n        var apiKey = 'roomle_portal_v2';\n        var tokenEncoded = today.toISOString() + ';' + token + ';' + apiKey;\n        tokenEncoded = '03-' + window.btoa(tokenEncoded);\n        return this.requestService.fetchJSON(Environment_1.Environment.config.rmlco, {\n            method: 'POST',\n            headers: {\n                'apiKey': 'roomle_portal_v2',\n                'currentTenant': 9,\n                'language': 'en',\n                'locale': 'en',\n                'token': tokenEncoded\n            },\n            body: {\n                shortId: {\n                    type: shortenId,\n                    referencedId: id\n                }\n            }\n        });\n    };\n    DomBuilderService.prototype.isAvailableLink = function (linkType) {\n        if (ButtonsService_1.ButtonsService.convertButtonTypeToEnum(linkType) === ButtonsService_1.BUTTON_TYPE.MARK) {\n            return false;\n        }\n        if (ButtonsService_1.ButtonsService.convertButtonTypeToEnum(linkType) === ButtonsService_1.BUTTON_TYPE.START_NOW) {\n            return false;\n        }\n        return true;\n    };\n    DomBuilderService.prototype.createDeeplinkInput = function (container, link) {\n        container.innerHTML = '';\n        var input = document.createElement('input');\n        input.setAttribute('type', 'text');\n        input.setAttribute('value', link);\n        input.setAttribute('readonly', 'readonly');\n        input.addEventListener('click', function (e) {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n            input.select();\n        });\n        container.appendChild(input);\n        return input;\n    };\n    DomBuilderService.prototype.createCopySvg = function (container, input) {\n        if (typeof document.execCommand !== 'function') {\n            return;\n        }\n        var copySvg = this.iconsService.createCopy();\n        copySvg.classList.add('rml-clickable');\n        copySvg.classList.add('rml-fake-link');\n        copySvg.classList.add('rml-icons__copy');\n        copySvg.addEventListener('click', function () {\n            input.select();\n            try {\n                document.execCommand('copy');\n            }\n            catch (e) {\n            }\n        });\n        container.appendChild(copySvg);\n    };\n    DomBuilderService.prototype.addShortlink = function (element, type, buttonType, id) {\n        var _this = this;\n        var h3 = element.querySelector('.rml-deeplink--link');\n        var needsAppend = false;\n        if (!h3) {\n            h3 = document.createElement('span');\n            needsAppend = true;\n        }\n        h3.classList.add('rml-deeplink--link');\n        h3.classList.add('rml-deeplink--heading');\n        h3.classList.add('text--red');\n        if (needsAppend) {\n            element.appendChild(h3);\n        }\n        var cacheKey = type + ':' + id;\n        var cachedLink = this.shortLinkCache[cacheKey];\n        if (cachedLink) {\n            var inputCached = this.createDeeplinkInput(h3, cachedLink);\n            this.createCopySvg(h3, inputCached);\n        }\n        else {\n            if (this.waitingForShortLink) {\n                return;\n            }\n            this.waitingForShortLink = true;\n            var spinner_1 = document.createElement('span');\n            spinner_1.classList.add('rml-spinner');\n            spinner_1.classList.add('rml-spinner--white');\n            h3.appendChild(spinner_1);\n            this.buildDeeplink(type, id).then(function (shortLink) {\n                var link = Environment_1.Environment.config.shortlink(RoomleTypeService_1.RoomleTypeService.convertRoomleType(type), id, buttonType, shortLink.shortId.shortId);\n                var input = _this.createDeeplinkInput(h3, link);\n                _this.createCopySvg(h3, input);\n                _this.shortLinkCache[cacheKey] = link;\n                _this.waitingForShortLink = false;\n            }, function () {\n                _this.waitingForShortLink = false;\n                h3.removeChild(spinner_1);\n                h3.textContent = SettingsService_1.SettingsService.settings.translations.errors.deeplinkcreate;\n            });\n        }\n    };\n    DomBuilderService.prototype.buildLink = function (link, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var _a = options.isHighlighted, isHighlighted = _a === void 0 ? false : _a, _b = options.buildAnyway, buildAnyway = _b === void 0 ? false : _b, _c = options.slideMode, slideMode = _c === void 0 ? false : _c, _d = options.clickedHint, clickedHint = _d === void 0 ? function () {\n        } : _d;\n        if (!this.isAvailableLink(link.type) && !buildAnyway) {\n            return;\n        }\n        var container = document.createElement('a');\n        container.classList.add('rml-deeplink--row');\n        container.setAttribute('target', '_blank');\n        container.setAttribute('href', link.link);\n        var text = document.createElement('span');\n        text.classList.add('rml-deeplink--text');\n        text.classList.add('rml-deeplink--heading');\n        text.textContent = SettingsService_1.SettingsService.settings.translations[link.type].heading;\n        var icon = document.createElement('span');\n        icon.classList.add('rml-deeplink--icon');\n        var svgIcon = this.iconsService.create(link.type);\n        icon.appendChild(svgIcon); //= 'i';//SettingsService.settings.translations[link.type].icon;\n        container.appendChild(text);\n        container.appendChild(icon);\n        var callback = SettingsService_1.SettingsService.settings.callback.button[link.type];\n        if (callback) {\n            container.addEventListener('click', function () {\n                callback(link.id, RoomleTypeService_1.RoomleTypeService.convertRoomleType(link.roomleType), link.type);\n            });\n        }\n        if (link.alternate) {\n            var alternate_1 = document.createElement('span');\n            alternate_1.classList.add('rml-deeplink--hint');\n            alternate_1.textContent = SettingsService_1.SettingsService.settings.translations[link.type].hint[link.alternate];\n            container.appendChild(alternate_1);\n            container.addEventListener('click', function (e) {\n                e.preventDefault();\n                if (slideMode) {\n                    alternate_1.classList.add('rml-hint__slide');\n                }\n                else {\n                    if (alternate_1.classList.contains('rml-hint__show')) {\n                        alternate_1.classList.remove('rml-hint__show');\n                    }\n                    else {\n                        _this.addShortlink(alternate_1, link.roomleType, link.type, link.id);\n                        alternate_1.classList.add('rml-hint__show');\n                    }\n                }\n                clickedHint();\n                return false;\n            });\n            if (isHighlighted) {\n                setTimeout(function () {\n                    alternate_1.classList.add('rml-hint__show');\n                    if (slideMode) {\n                        alternate_1.classList.add('rml-hint__slide');\n                        clickedHint();\n                    }\n                    else {\n                        _this.addShortlink(alternate_1, link.roomleType, link.type, link.id);\n                    }\n                }, 1);\n            }\n        }\n        else {\n            if (link.os !== 'desktop') {\n                this.mobileRedirectService.createDeeplinkFor(container, link.os);\n            }\n        }\n        return container;\n    };\n    return DomBuilderService;\n}(Service_1.Service));\nexports.DomBuilderService = DomBuilderService;\n\n},{\"../config/Environment\":2,\"../controllers/PopupController\":5,\"../lib/Service\":8,\"../services/RequestService\":19,\"./ButtonsService\":10,\"./ConsoleService\":11,\"./IconsService\":14,\"./MobileDetectService\":16,\"./MobileRedirectService\":17,\"./RoomleTypeService\":20,\"./SettingsService\":21}],13:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar RoomleTypeService_1 = require(\"./RoomleTypeService\");\nvar ButtonsService_1 = require(\"./ButtonsService\");\nvar SettingsService_1 = require(\"./SettingsService\");\nvar MobileDetectService_1 = require(\"./MobileDetectService\");\nvar EVENT_TYPES;\n(function (EVENT_TYPES) {\n    EVENT_TYPES[EVENT_TYPES[\"TRIGGER\"] = 0] = \"TRIGGER\";\n    EVENT_TYPES[EVENT_TYPES[\"POP_UP_OPEN\"] = 1] = \"POP_UP_OPEN\";\n    EVENT_TYPES[EVENT_TYPES[\"POP_UP_CLOSE\"] = 2] = \"POP_UP_CLOSE\";\n})(EVENT_TYPES = exports.EVENT_TYPES || (exports.EVENT_TYPES = {}));\nvar EventHandlerService = (function (_super) {\n    __extends(EventHandlerService, _super);\n    function EventHandlerService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.mobileDetectService = MobileDetectService_1.MobileDetectService.inject();\n        _this.triggerCallbacks = [];\n        _this.openPopUpCallbacks = [];\n        return _this;\n    }\n    EventHandlerService.prototype.subscribe = function (event, callback) {\n        if (event === EVENT_TYPES.TRIGGER) {\n            this.triggerCallbacks.push(callback);\n        }\n        if (event === EVENT_TYPES.POP_UP_OPEN) {\n            this.openPopUpCallbacks.push(callback);\n        }\n    };\n    EventHandlerService.prototype.findSelector = function (element, selector, depth, maxDepth) {\n        if (depth === void 0) { depth = 0; }\n        if (maxDepth === void 0) { maxDepth = 20; }\n        if (maxDepth === depth) {\n            return null;\n        }\n        if (element.matches && element.matches(selector)) {\n            return element;\n        }\n        var parent = element.parentElement || element.parentNode;\n        if (!parent) {\n            return null;\n        }\n        return this.findSelector(parent, selector, depth + 1);\n    };\n    EventHandlerService.prototype.dispatchOpenPopUp = function (e) {\n        this.openPopUpCallbacks.forEach(function (callback) {\n            callback(e);\n        });\n    };\n    // DO NOT USE ENUM FOR TYPE, BECAUSE CALLBACKS ARE ON \"item\" and not \"0\"\n    EventHandlerService.prototype.dispatch = function (e, type, id, buttonType, highlight, newWindow) {\n        if (highlight === void 0) { highlight = null; }\n        if (newWindow === void 0) { newWindow = false; }\n        var clickedButton = ButtonsService_1.ButtonsService.convertButtonType(buttonType);\n        var links = this.mobileDetectService.getLinks(id, RoomleTypeService_1.RoomleTypeService.convertTypeToEnum(type));\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.TRIGGER) {\n            var triggerKey = ButtonsService_1.ButtonsService.convertButtonType(ButtonsService_1.BUTTON_TYPE.TRIGGER);\n            var callbackTrigger = SettingsService_1.SettingsService.settings.callback[triggerKey];\n            if (typeof callbackTrigger === 'function') {\n                callbackTrigger(e, id, type, links, highlight, newWindow);\n            }\n            this.triggerCallbacks.forEach(function (callback) {\n                callback(e, id, type, links, highlight, newWindow);\n            });\n        }\n        var callbackForType = SettingsService_1.SettingsService.settings.callback[type];\n        if (callbackForType && callbackForType[clickedButton] && typeof callbackForType[clickedButton] === 'function') {\n            callbackForType[clickedButton](e, id, type, links, highlight, newWindow);\n        }\n    };\n    EventHandlerService.prototype.getElement = function (parent, selector) {\n        var elements = parent.querySelectorAll('[' + selector + ']');\n        if (!elements || elements.length === 0) {\n            if (parent.hasAttribute(selector)) {\n                return parent;\n            }\n        }\n        return elements[0];\n    };\n    EventHandlerService.prototype.handle = function (e) {\n        var target = (e.target || e.srcElement);\n        var button = this.findSelector(target, '[' + SettingsService_1.SettingsService.settings.dataSelector.action + ']');\n        if (!button) {\n            return;\n        }\n        var buttonType = button.getAttribute(SettingsService_1.SettingsService.settings.dataSelector.action);\n        if (buttonType) {\n            var roomleElement = this.findSelector(target, SettingsService_1.SettingsService.settings.selector);\n            if (!roomleElement) {\n                return;\n            }\n            var typeElement = this.getElement(roomleElement, SettingsService_1.SettingsService.settings.dataSelector.type);\n            var type = null;\n            var id = null;\n            if (typeElement) {\n                type = typeElement.getAttribute(SettingsService_1.SettingsService.settings.dataSelector.type);\n            }\n            var idElement = this.getElement(roomleElement, SettingsService_1.SettingsService.settings.dataSelector.id);\n            if (idElement) {\n                id = idElement.getAttribute(SettingsService_1.SettingsService.settings.dataSelector.id);\n            }\n            this.dispatch(e, type, id, ButtonsService_1.ButtonsService.convertButtonTypeToEnum(buttonType));\n        }\n    };\n    return EventHandlerService;\n}(Service_1.Service));\nexports.EventHandlerService = EventHandlerService;\n\n},{\"../lib/Service\":8,\"./ButtonsService\":10,\"./MobileDetectService\":16,\"./RoomleTypeService\":20,\"./SettingsService\":21}],14:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar ButtonsService_1 = require(\"./ButtonsService\");\nvar IconsService = (function (_super) {\n    __extends(IconsService, _super);\n    function IconsService() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    IconsService.prototype.getSvg = function (attributes) {\n        attributes = attributes || {};\n        if (!attributes['width']) {\n            attributes['width'] = '64';\n        }\n        if (!attributes['height']) {\n            attributes['height'] = '64';\n        }\n        //attributes['xmlns'] = IconsService.SVG_NS;\n        var svg = document.createElementNS(IconsService.SVG_NS, 'svg');\n        for (var attribute in attributes) {\n            svg.setAttributeNS(null, attribute, attributes[attribute]);\n        }\n        return svg;\n    };\n    IconsService.prototype.getNode = function (name, attributes) {\n        var element = document.createElementNS(IconsService.SVG_NS, name);\n        for (var attribute in attributes) {\n            element.setAttributeNS(null, attribute, attributes[attribute]);\n        }\n        return element;\n    };\n    IconsService.prototype.buildPlanIcon = function (isPlus) {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var firstPath = this.getNode('path', {\n            d: 'M39.72,23.16,31,17.93h0l-.36-.22-5.13-3.07h0l-.36-.22a.33.33,0,0,0-.35,0l-.36.22h0l-13.87,8.3h0l-.36.22a.53.53,0,0,0,0,.85l.36.22h0l5.13,3.07h0l.36.22h0l8.38,5h0l.24.14.12.07a.33.33,0,0,0,.35,0L39.72,24a.53.53,0,0,0,0-.85Zm-5.09,2.4-3.34-2a.33.33,0,0,0-.35,0l-.36.22a.53.53,0,0,0,0,.85l2.8,1.68-8.43,5-7.49-4.48,2.89-1.73a.53.53,0,0,0,0-.85l-.18-.11h0l-.91-.54a.33.33,0,0,0-.35,0l-.36.22a.53.53,0,0,0,0,.85h0l-2.36,1.41L12,23.58l2.36-1.41,2.45,1.47a.34.34,0,0,0,.17,0,.34.34,0,0,0,.17,0l.36-.22a.53.53,0,0,0,0-.85l-1.91-1.14L25,15.82l4.24,2.54-7.85,4.7a.53.53,0,0,0,0,.85l.36.22a.33.33,0,0,0,.35,0l3.84-2.3,1.83,1.1a.34.34,0,0,0,.17,0,.34.34,0,0,0,.17,0l.36-.22a.53.53,0,0,0,0-.85l-1.3-.77,3.3-2,7.49,4.48Z',\n        });\n        /*let secondPath = this.getNode('path', {\n         d: 'M48,21.46L34.61,14.87h0l-0.55-.27-7.83-3.87h0l-0.55-.27a0.6,0.6,0,0,0-.53,0l-0.55.27h0L3.42,21.19h0l-0.55.27a0.6,0.6,0,0,0,0,1.08l0.55,0.27h0l7.83,3.87h0l0.55,0.27h0l12.8,6.32h0L25,33.45l0.18,0.09a0.61,0.61,0,0,0,.53,0L48,22.54A0.6,0.6,0,0,0,48,21.46Zm-7.77,3L35.09,22a0.6,0.6,0,0,0-.53,0L34,22.24a0.6,0.6,0,0,0,0,1.08l4.28,2.11L25.41,31.79,14,26.14,18.39,24a0.6,0.6,0,0,0,0-1.08l-0.28-.14h0l-1.39-.69a0.6,0.6,0,0,0-.53,0l-0.55.27a0.6,0.6,0,0,0,0,1.08h0l-3.6,1.78L5.59,22l3.6-1.78,3.74,1.85a0.61,0.61,0,0,0,.27.06,0.6,0.6,0,0,0,.27-0.06L14,21.8a0.6,0.6,0,0,0,0-1.08l-2.92-1.44,14.32-7.07,6.48,3.2-12,5.92a0.6,0.6,0,0,0,0,1.08l0.55,0.27a0.6,0.6,0,0,0,.53,0l5.86-2.89,2.8,1.38a0.61,0.61,0,0,0,.27.06,0.6,0.6,0,0,0,.27-0.06l0.55-.27a0.6,0.6,0,0,0,0-1.08l-2-1,5-2.49L45.24,22Z',\n         transform: 'translate(-2.53 -10.4)'\n         });*/\n        svg.appendChild(firstPath);\n        //svg.appendChild(secondPath);\n        if (isPlus) {\n            var thirdPath = this.getNode('path', {\n                d: 'M37.29,33.15v2.48h-1.4V33.15H33.42v-1.4h2.47V29.29h1.4v2.46h2.47v1.4Z',\n            });\n            svg.appendChild(thirdPath);\n        }\n        return svg;\n    };\n    IconsService.prototype.buildAdd = function () {\n        return this.buildPlanIcon(true);\n    };\n    IconsService.prototype.buildPlanNow = function () {\n        return this.buildPlanIcon(false);\n    };\n    IconsService.prototype.buildAr = function () {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var firstPath = this.getNode('path', {\n            d: 'M24.41,33.24h0c-5.22-.08-9.5-2.78-14.31-9a.75.75,0,0,1-.16-.46c0-.63,4.46-6.73,10.67-8.84,8.34-2.84,15,3,19.19,8.38a.75.75,0,0,1,.16.46c0,.45-.63,1.34-1.87,2.63a.75.75,0,0,1-1.09-1,13.24,13.24,0,0,0,1.3-1.52c-4.4-5.57-9-8.3-13.69-8.15-6.69.23-11.71,6.36-13,8.06,5.49,7,9.55,8,12.8,8a.75.75,0,0,1,0,1.5Z',\n        });\n        var secondPath = this.getNode('path', {\n            d: 'M24.94,29.4a5.42,5.42,0,0,1-5.05-3.5,5.58,5.58,0,0,1,1.56-6.51,5.3,5.3,0,0,1,6.44-.3,5.66,5.66,0,0,1,2.34,6.39A.75.75,0,1,1,28.79,25a4.18,4.18,0,0,0-1.74-4.7,3.79,3.79,0,0,0-4.65.21,4.12,4.12,0,0,0-1.12,4.79,3.9,3.9,0,0,0,4,2.55.74.74,0,0,1,.81.69.75.75,0,0,1-.69.81Z',\n        });\n        var graph = this.getNode('g');\n        var thirdPath = this.getNode('path', {\n            d: 'M30.5,35.1,30,33.68H27.18L26.7,35.1H25.06l2.92-8h1.23l2.93,8Zm-1.87-5.65-1,2.92h2Z',\n        });\n        var fourthPath = this.getNode('path', {\n            d: 'M37.39,35.1l-1.57-3.2H34.69v3.2H33.13v-8h3.14a2.42,2.42,0,0,1,2.6,2.46,2.16,2.16,0,0,1-1.46,2.11L39.2,35.1Zm-1.22-6.62H34.69v2.12h1.48a1.06,1.06,0,1,0,0-2.12Z',\n        });\n        graph.appendChild(thirdPath);\n        graph.appendChild(fourthPath);\n        svg.appendChild(firstPath);\n        svg.appendChild(secondPath);\n        svg.appendChild(graph);\n        return svg;\n    };\n    IconsService.prototype.buildConfigure = function () {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var path = this.getNode('path', {\n            d: 'M34.67,10.9,28.9,8.22a1.87,1.87,0,0,0-2.48.91L16,31.42a1.86,1.86,0,0,0-.17.75L15.66,40a1.85,1.85,0,0,0,.53,1.34,1.9,1.9,0,0,0,1.35.57,1.86,1.86,0,0,0,1.23-.47l5.93-5.22a1.86,1.86,0,0,0,.46-.62L35.58,13.37A1.88,1.88,0,0,0,34.67,10.9ZM17.47,40.22l.14-7,4.91,2.55ZM32,16.94l-5.88-2.73,1.94-4.38L34,12.57Z',\n        });\n        svg.appendChild(path);\n        return svg;\n    };\n    IconsService.prototype.buildMark = function () {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var path = this.getNode('path', {\n            d: 'M32.16,12.05A7.89,7.89,0,0,0,25,16.51,7.93,7.93,0,0,0,10,20C10,29.35,25,39.64,25,39.64s15-10.37,15-19.66A7.91,7.91,0,0,0,32.16,12.05Z',\n        });\n        svg.appendChild(path);\n        return svg;\n    };\n    IconsService.prototype.buildCopy = function () {\n        var svg = this.getSvg({ viewBox: '0 0 32 32' });\n        var firstPath = this.getNode('path', {\n            d: 'M28.681 11.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-11.5c-1.379 0-2.5 1.122-2.5 2.5v23c0 1.378 1.121 2.5 2.5 2.5h19c1.378 0 2.5-1.122 2.5-2.5v-15.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 9.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268v0zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-19c-0.271 0-0.5-0.229-0.5-0.5v-23c0-0.271 0.229-0.5 0.5-0.5 0 0 11.499-0 11.5 0v7c0 0.552 0.448 1 1 1h7v15.5z',\n        });\n        var secondPath = this.getNode('path', {\n            d: 'M18.841 1.319c-1.612-1.182-2.393-1.319-2.841-1.319h-11.5c-1.378 0-2.5 1.121-2.5 2.5v23c0 1.207 0.86 2.217 2 2.45v-25.45c0-0.271 0.229-0.5 0.5-0.5h15.215c-0.301-0.248-0.595-0.477-0.873-0.681z',\n        });\n        svg.appendChild(firstPath);\n        svg.appendChild(secondPath);\n        return svg;\n    };\n    IconsService.prototype.buildTrigger = function () {\n        var svg = this.getSvg({ viewBox: '0 0 32.19 29.5' });\n        var path1 = this.getNode('path', {\n            d: 'M21,22.36c-1.57,0-1.87,1.36-1.87,3s0.17,3,1.87,3,1.87-1.36,1.87-3S22.59,22.36,21,22.36Z',\n            transform: 'translate(-9 -15.26)'\n        });\n        var path2 = this.getNode('path', {\n            d: 'M31.1,22.36c-1.57,0-1.87,1.36-1.87,3s0.17,3,1.87,3S33,27,33,25.36,32.66,22.36,31.1,22.36Z',\n            transform: 'translate(-9 -15.26)'\n        });\n        var path3 = this.getNode('path', {\n            d: 'M26,15.26c-5.86,0-17,.73-17,3.48V31.89a1.16,1.16,0,0,0,.17.49c1,2.06,9.46,3,16.85,3,5.86,0,17-.73,17-3.48V18.74C43,16,31.86,15.26,26,15.26ZM21,30.11c-3.46,0-4.69-2.14-4.69-4.79S17.6,20.53,21,20.53s4.69,2.14,4.69,4.79S24.47,30.11,21,30.11Zm10.08,0c-3.46,0-4.69-2.14-4.69-4.79s1.28-4.79,4.69-4.79,4.69,2.14,4.69,4.79S34.55,30.11,31.1,30.11Z',\n            transform: 'translate(-9 -15.26)'\n        });\n        var path4 = this.getNode('path', {\n            d: 'M31.1,28.36c-1.7,0-1.87-1.36-1.87-3s0.3-3,1.87-3,1.87,1.36,1.87,3S32.8,28.36,31.1,28.36Z',\n            transform: 'translate(-9 -15.26)'\n        });\n        var path5 = this.getNode('path', {\n            d: 'M21,28.36c-1.7,0-1.87-1.36-1.87-3s0.3-3,1.87-3,1.87,1.36,1.87,3S22.72,28.36,21,28.36Z',\n            transform: 'translate(-9 -15.26)'\n        });\n        svg.appendChild(path1);\n        svg.appendChild(path2);\n        svg.appendChild(path3);\n        svg.appendChild(path4);\n        svg.appendChild(path5);\n        return svg;\n    };\n    IconsService.prototype.buildVisualize = function () {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var path = this.getNode('path', {\n            d: 'M25,34.59c-6.32,0-11.44-4.71-14.84-9.13a.75.75,0,0,1,0-.87c.24-.36,6-8.87,14.49-9.17C29.9,15.23,35,18.3,39.85,24.55A.74.74,0,0,1,40,25c0,.6-4.61,6.78-10.68,8.84A13.47,13.47,0,0,1,25,34.59ZM11.65,25c4.4,5.55,9,8.28,13.68,8.12,6.7-.23,11.74-6.38,13-8.08-4.4-5.55-9-8.28-13.69-8.12C17.93,17.14,12.91,23.28,11.65,25ZM25,30.49A5.49,5.49,0,1,1,30.38,25,5.45,5.45,0,0,1,25,30.49ZM25,21a4,4,0,1,0,3.91,4A4,4,0,0,0,25,21Z',\n        });\n        svg.appendChild(path);\n        return svg;\n    };\n    IconsService.prototype.buildVr = function () {\n        var svg = this.getSvg({ viewBox: '0 0 50 50' });\n        var path = this.getNode('path', {\n            d: 'M37.88,16.24H12.18A2.16,2.16,0,0,0,10,18.4V31.6a2.16,2.16,0,0,0,2.16,2.16H20a1.54,1.54,0,0,0,1.46-.93l1.75-4.38a1.92,1.92,0,0,1,3.5.06l1.52,4.26a1.59,1.59,0,0,0,1.46,1h8.12A2.16,2.16,0,0,0,40,31.6V18.46A2.05,2.05,0,0,0,37.88,16.24ZM18.6,28.8a3.33,3.33,0,0,1-3.33-3.33,3.33,3.33,0,1,1,6.66,0A3.33,3.33,0,0,1,18.6,28.8Zm12.85,0a3.33,3.33,0,0,1-3.33-3.33,3.33,3.33,0,0,1,6.66,0A3.33,3.33,0,0,1,31.45,28.8Z',\n        });\n        svg.appendChild(path);\n        return svg;\n    };\n    IconsService.prototype.create = function (buttonType) {\n        var button = ButtonsService_1.ButtonsService.convertButtonTypeToEnum(buttonType);\n        if (button === ButtonsService_1.BUTTON_TYPE.ADD) {\n            return this.buildAdd();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.AR) {\n            return this.buildAr();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.CONFIGURE) {\n            return this.buildConfigure();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.VISUALIZE) {\n            return this.buildVisualize();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.VR) {\n            return this.buildVr();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.TRIGGER) {\n            return this.buildTrigger();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.MARK) {\n            return this.buildMark();\n        }\n        if (button === ButtonsService_1.BUTTON_TYPE.START_NOW) {\n            return this.buildPlanNow();\n        }\n    };\n    IconsService.prototype.createCopy = function () {\n        return this.buildCopy();\n    };\n    return IconsService;\n}(Service_1.Service));\nIconsService.SVG_NS = 'http://www.w3.org/2000/svg';\nexports.IconsService = IconsService;\n\n},{\"../lib/Service\":8,\"./ButtonsService\":10}],15:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar ImagesService = (function (_super) {\n    __extends(ImagesService, _super);\n    function ImagesService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.images = {\n            ios: 'https://a.storyblok.com/f/4e779959c8/ios.png',\n            android: 'https://a.storyblok.com/f/1386db8cd0/android.png',\n            desktop: 'https://a.storyblok.com/f/cf5aa03c64/desktop.png',\n        };\n        return _this;\n    }\n    ImagesService.prototype.preloadImages = function () {\n        var ios = new Image();\n        var android = new Image();\n        var desktop = new Image();\n        ios.src = this.images.ios;\n        android.src = this.images.android;\n        desktop.src = this.images.desktop;\n    };\n    return ImagesService;\n}(Service_1.Service));\nexports.ImagesService = ImagesService;\n\n},{\"../lib/Service\":8}],16:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar RoomleTypeService_1 = require(\"./RoomleTypeService\");\nvar ButtonsService_1 = require(\"./ButtonsService\");\nvar SettingsService_1 = require(\"./SettingsService\");\nvar MobileDetectService = (function (_super) {\n    __extends(MobileDetectService, _super);\n    function MobileDetectService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isOSCached = null;\n        _this.isAndroidCached = null;\n        _this.isIPadCached = null;\n        _this.isSupportedMobileCached = null;\n        _this.buttonsService = ButtonsService_1.ButtonsService.inject();\n        return _this;\n    }\n    MobileDetectService.prototype.isIOS = function () {\n        if (this.isOSCached !== null) {\n            return this.isOSCached;\n        }\n        return /iPad|iPhone|iPod/i.test(navigator.userAgent) && !window.MSStream; // USE MSStream because of http://stackoverflow.com/a/9039885\n    };\n    MobileDetectService.prototype.isAndroid = function () {\n        if (this.isAndroidCached !== null) {\n            return this.isAndroidCached;\n        }\n        return /Android/i.test(navigator.userAgent) && !window.MSStream; // USE MSStream because of http://stackoverflow.com/a/9039885\n    };\n    MobileDetectService.prototype.isSupportedMobile = function () {\n        if (this.isSupportedMobileCached !== null) {\n            return this.isSupportedMobileCached;\n        }\n        return this.isIOS() || this.isAndroid();\n    };\n    MobileDetectService.prototype.isIPad = function () {\n        if (this.isIPadCached !== null) {\n            return this.isIPadCached;\n        }\n        return /iPad/i.test(navigator.userAgent) && !window.MSStream; // USE MSStream because of http://stackoverflow.com/a/9039885\n    };\n    MobileDetectService.prototype.handlePlan = function (id, type, buttonType) {\n        var buttonTypeStr = ButtonsService_1.ButtonsService.convertButtonType(buttonType);\n        var typeStr = type;\n        var iosPlanLink = 'roomle://3d/planId/' + id;\n        var desktopLink = SettingsService_1.SettingsService.settings.web.baseUrl + 'editor/' + id;\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.VISUALIZE) {\n            var viewrLink = 'roomleviewer://plan/' + id;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: viewrLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: iosPlanLink,\n                    os: 'ios',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            return {\n                type: buttonTypeStr,\n                alternate: null,\n                link: desktopLink,\n                os: 'desktop',\n                roomleType: typeStr,\n                id: id\n            };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.VR) {\n            var viewrLink = 'roomleviewer://vr/' + id;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: viewrLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return { type: buttonTypeStr, alternate: null, link: viewrLink, os: 'ios', roomleType: typeStr, id: id };\n            }\n            return { type: buttonTypeStr, alternate: 'ios', link: viewrLink, os: 'desktop', roomleType: typeStr, id: id };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.START_NOW) {\n            var viewrLink = 'roomleviewer://plan/' + id;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: viewrLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: iosPlanLink,\n                    os: 'ios',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            return {\n                type: buttonTypeStr,\n                alternate: null,\n                link: desktopLink,\n                os: 'desktop',\n                roomleType: typeStr,\n                id: id\n            };\n        }\n        return null;\n    };\n    MobileDetectService.prototype.createLinkForItemOrConfiguration = function (id, type, buttonType, isItem) {\n        var typeStr = type;\n        var buttonTypeStr = ButtonsService_1.ButtonsService.convertButtonType(buttonType);\n        if (isItem) {\n        }\n        var iosIdentifier = (!isItem && type !== RoomleTypeService_1.ROOMLE_TYPE.CONFIGURABLE_ITEM) ? 'configurationId' : 'catalogItemId';\n        var webIdentifier = (!isItem && type !== RoomleTypeService_1.ROOMLE_TYPE.CONFIGURABLE_ITEM) ? 'configurationId[]' : 'itemId[]';\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.ADD) {\n            var desktopLink = SettingsService_1.SettingsService.settings.web.baseUrl + 'editor/' + SettingsService_1.SettingsService.settings.planId + '?' + webIdentifier + '=' + id;\n            var iosLink = 'roomle://addToPlan/' + iosIdentifier + '/' + id + '?planId=' + SettingsService_1.SettingsService.settings.planId;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: 'desktop',\n                    link: desktopLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return null; //{type: buttonTypeStr, alternate: null, link: iosLink, os: 'ios', roomleType: typeStr, id: id};\n            }\n            return {\n                type: buttonTypeStr,\n                alternate: null,\n                link: desktopLink,\n                os: 'desktop',\n                roomleType: typeStr,\n                id: id\n            };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.AR) {\n            var iosLink = 'roomle://ar/' + iosIdentifier + '/' + id;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: 'ios',\n                    link: iosLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return { type: buttonTypeStr, alternate: null, link: iosLink, os: 'ios', roomleType: typeStr, id: id };\n            }\n            return { type: buttonTypeStr, alternate: 'ios', link: iosLink, os: 'desktop', roomleType: typeStr, id: id };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.CONFIGURE && (type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURATION || type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURABLE_ITEM)) {\n            var isConfigurableItem = (type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURATION) ? false : true;\n            var desktopLink = SettingsService_1.SettingsService.settings.web.baseUrl + 'configurator/' + id + (isConfigurableItem ? '?isItem=true' : '');\n            var iosLink = 'roomle://configuration/' + iosIdentifier + '/' + id;\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: 'desktop',\n                    link: desktopLink,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return { type: buttonTypeStr, alternate: null, link: iosLink, os: 'ios', roomleType: typeStr, id: id };\n            }\n            return {\n                type: buttonTypeStr,\n                alternate: null,\n                link: desktopLink,\n                os: 'desktop',\n                roomleType: typeStr,\n                id: id\n            };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.MARK) {\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: 'www.roomle.com',\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: 'www.roomle.com',\n                    os: 'ios',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            return {\n                type: buttonTypeStr,\n                alternate: null,\n                link: 'www.roomle.com',\n                os: 'desktop',\n                roomleType: typeStr,\n                id: id\n            };\n        }\n        if (buttonType === ButtonsService_1.BUTTON_TYPE.VISUALIZE) {\n            if (this.isAndroid()) {\n                return {\n                    type: buttonTypeStr,\n                    alternate: null,\n                    link: 'roomleviewer://item/' + id,\n                    os: 'android',\n                    roomleType: typeStr,\n                    id: id\n                };\n            }\n            if (this.isIOS()) {\n                return null;\n            }\n            return null; // {type: buttonTypeStr, alternate: '', link: 'www.roomle'};\n        }\n        return null;\n    };\n    MobileDetectService.prototype.handleItem = function (id, type, buttonType) {\n        var isItem = true;\n        return this.createLinkForItemOrConfiguration(id, type, buttonType, isItem);\n    };\n    MobileDetectService.prototype.handleConfiguration = function (id, type, buttonType) {\n        var isItem = false;\n        return this.createLinkForItemOrConfiguration(id, type, buttonType, isItem);\n    };\n    MobileDetectService.prototype.generateLink = function (id, type, buttonType, callbackUrl) {\n        if (callbackUrl === void 0) { callbackUrl = null; }\n        var deeplink = null;\n        if (type === RoomleTypeService_1.ROOMLE_TYPE.ITEM) {\n            deeplink = this.handleItem(id, type, buttonType);\n        }\n        else if (type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURATION || type === RoomleTypeService_1.ROOMLE_TYPE.CONFIGURABLE_ITEM) {\n            deeplink = this.handleConfiguration(id, type, buttonType);\n        }\n        else if (type === RoomleTypeService_1.ROOMLE_TYPE.PLAN) {\n            deeplink = this.handlePlan(id, type, buttonType);\n        }\n        if (!deeplink) {\n            return null;\n        }\n        var seperator = deeplink.link.indexOf('?') === -1 ? '?' : '&';\n        deeplink.link = deeplink.link + seperator + 'callback=' + callbackUrl;\n        return deeplink;\n    };\n    MobileDetectService.prototype.getLinks = function (id, type, callbackUrl) {\n        var _this = this;\n        if (callbackUrl === void 0) { callbackUrl = null; }\n        var availableButtons = this.buttonsService.availableButtons;\n        var links = [];\n        availableButtons.forEach(function (button) {\n            var link = _this.generateLink(id, type, button, callbackUrl);\n            if (link) {\n                links.push(link);\n            }\n        });\n        return links;\n    };\n    return MobileDetectService;\n}(Service_1.Service));\nexports.MobileDetectService = MobileDetectService;\n\n},{\"../lib/Service\":8,\"./ButtonsService\":10,\"./RoomleTypeService\":20,\"./SettingsService\":21}],17:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar MobileRedirectService = (function (_super) {\n    __extends(MobileRedirectService, _super);\n    function MobileRedirectService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.delay = 1200;\n        _this.oss = {\n            android: {\n                storePrefix: 'https://play.google.com/store/apps/details?id='\n            },\n            ios: {\n                storePrefix: 'https://itunes.apple.com/app/'\n            }\n        };\n        return _this;\n    }\n    MobileRedirectService.prototype.getTime = function () {\n        return new Date().getTime();\n    };\n    MobileRedirectService.prototype.open = function (url, newWindow, callback) {\n        if (newWindow === void 0) { newWindow = false; }\n        if (callback === void 0) { callback = null; }\n        if (typeof callback === 'function') {\n            return callback(url);\n        }\n        if (newWindow) {\n            window.open(url);\n        }\n        else {\n            window.location.href = url;\n        }\n    };\n    MobileRedirectService.prototype.handleAndroidBrowsers = function (appId, href, scheme) {\n        // Android Mobile\n        var isAndroidMobile = navigator.userAgent.indexOf('Android') > -1 &&\n            navigator.userAgent.indexOf('Mozilla/5.0') > -1 &&\n            navigator.userAgent.indexOf('AppleWebKit') > -1;\n        // Android Browser (not Chrome)\n        var regExAppleWebKit = new RegExp('AppleWebKit\\/([\\d.]+)');\n        var resultAppleWebKitRegEx = regExAppleWebKit.exec(navigator.userAgent);\n        var appleWebKitVersion = (resultAppleWebKitRegEx === null ? null : parseFloat(regExAppleWebKit.exec(navigator.userAgent)[1]));\n        var isAndroidBrowser = isAndroidMobile && appleWebKitVersion !== null && appleWebKitVersion > 500;\n        if (isAndroidBrowser) {\n            return 'intent:' + href.split(':')[1] + '#Intent;scheme=' + scheme + ';package=' +\n                appId + ';S.browser_fallback_url=' + encodeURI(href);\n        }\n        else {\n            return href;\n        }\n    };\n    MobileRedirectService.prototype.redirect = function (deeplink, newWindow, callback) {\n        if (newWindow === void 0) { newWindow = false; }\n        if (callback === void 0) { callback = null; }\n        this.perfromDeepLink(deeplink.link, deeplink.os, newWindow, callback);\n    };\n    MobileRedirectService.prototype.perfromDeepLink = function (href, os, newWindow, callback) {\n        var _this = this;\n        if (newWindow === void 0) { newWindow = false; }\n        if (callback === void 0) { callback = null; }\n        var clicked = false;\n        var timeout = null;\n        var data = this.parseHref(href, os);\n        var scheme = data.scheme;\n        var appId = data.appId;\n        var start = this.getTime();\n        clicked = true;\n        timeout = setTimeout(function () {\n            if (os === 'desktop') {\n                return;\n            }\n            if (!clicked || !timeout) {\n                return;\n            }\n            var now = _this.getTime();\n            clicked = false;\n            timeout = null;\n            if (now - start >= _this.delay * 2) {\n                return;\n            }\n            if (appId) {\n                _this.open(_this.oss[os].storePrefix + appId, newWindow);\n            }\n            else if (href) {\n                _this.open(href, newWindow);\n            }\n        }, this.delay);\n        //appId, this.oss[os].storePrefix + appId, href, scheme\n        var finalURI = this.handleAndroidBrowsers(appId, href, scheme);\n        this.open(finalURI, newWindow, callback);\n    };\n    MobileRedirectService.prototype.parseHref = function (href, osin) {\n        var hrefParts = href.split(':');\n        var scheme = hrefParts[0];\n        var appId = 'roomle/id732050356';\n        if (scheme === 'roomleviewer') {\n            appId = 'com.roomle.viewer';\n            if (osin === 'ios') {\n                appId = 'roomle-viewr/id1053860177';\n            }\n        }\n        return { appId: appId, scheme: scheme, os: osin };\n    };\n    MobileRedirectService.prototype.createDeeplinkFor = function (el, os) {\n        var _this = this;\n        var href = el.getAttribute('href');\n        var data = this.parseHref(href, os);\n        var appId = data.appId;\n        if (os && appId) {\n            el.addEventListener('click', function (e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                _this.perfromDeepLink(href, os);\n            });\n        }\n        else if (!href || href === '#') {\n            el.style.display = 'none';\n        }\n    };\n    ;\n    return MobileRedirectService;\n}(Service_1.Service));\nexports.MobileRedirectService = MobileRedirectService;\n\n},{\"../lib/Service\":8}],18:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Service_1 = require(\"../lib/Service\");\nvar PolyfillService = (function (_super) {\n    __extends(PolyfillService, _super);\n    function PolyfillService() {\n        var _this = _super.call(this) || this;\n        if (!Element.prototype.matches) {\n            // CAST TO ANY AS QUICK&DIRTY SOLUTION FOR NON STANDARD NAMES!\n            Element.prototype.matches =\n                Element.prototype.matchesSelector ||\n                    Element.prototype.mozMatchesSelector ||\n                    Element.prototype.msMatchesSelector ||\n                    Element.prototype.oMatchesSelector ||\n                    Element.prototype.webkitMatchesSelector ||\n                    function (s) {\n                        var matches = (this.document || this.ownerDocument).querySelectorAll(s), i = matches.length;\n                        while (--i >= 0 && matches.item(i) !== this) {\n                        }\n                        return i > -1;\n                    };\n        }\n        return _this;\n    }\n    return PolyfillService;\n}(Service_1.Service));\nexports.PolyfillService = PolyfillService;\n\n},{\"../lib/Service\":8}],19:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n//import { Promise } from 'es6-promise';\nvar Service_1 = require(\"../lib/Service\");\nvar RequestService = (function (_super) {\n    __extends(RequestService, _super);\n    function RequestService() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RequestService.prototype.fetch = function (url, options) {\n        return new Promise(function (resolve, reject) {\n            if (!options) {\n                options = {};\n            }\n            var xhr = new XMLHttpRequest();\n            var headers = options.headers;\n            // Check if method is GET and body ias an object\n            // If it is so, parse body object an append all properties as GET parameters to the url\n            if (options.method === 'GET' && options.body) {\n                if (typeof options.body === 'object') {\n                    var separator = '';\n                    var uri = '';\n                    for (var key in options.body) {\n                        if (options.body.hasOwnProperty(key)) {\n                            var encodedKey = encodeURIComponent(key);\n                            var encodedContent = encodeURIComponent(options.body[key]);\n                            uri += \"\" + separator + encodedKey + \"=\" + encodedContent;\n                            separator = '&';\n                        }\n                    }\n                    // append the parameters to the url\n                    url = url + (url.indexOf('?') === -1 ? '?' : '&') + uri;\n                }\n                else {\n                    // Body is not an object => not allowed\n                    reject(new TypeError('Non object like body not allowed for GET requests. The body has to be an object so the properties will be appended as a GET parameter to the url.'));\n                    return;\n                }\n            }\n            else if (typeof options.body !== 'string') {\n                // if body is not a string, parse it to a json string\n                options.body = JSON.stringify(options.body);\n            }\n            // Body not allowed for HEAD requests\n            if (options.method === 'HEAD' && options.body) {\n                reject(new TypeError('Body not allowed for HEAD requests'));\n                return;\n            }\n            // Add onload event listener\n            xhr.onload = function (event) {\n                if (xhr.status >= 400 || xhr.status === 0) {\n                    reject(new Error(xhr.responseText));\n                }\n                else {\n                    resolve('response' in xhr ? xhr.response : xhr.responseText);\n                }\n            };\n            // Add onerror event listener\n            xhr.onerror = function (event) {\n                reject(event.error);\n            };\n            xhr.onabort = function (event) {\n                reject(new TypeError('Network request aborted'));\n            };\n            // Add timeout event listener\n            xhr.ontimeout = function (event) {\n                reject(new TypeError('Network request timed out'));\n            };\n            if (options.credentials && options.credentials.username) {\n                xhr.open(options.method ? options.method : 'GET', url, true, options.credentials.username, options.credentials.password);\n            }\n            else {\n                xhr.open(options.method ? options.method : 'GET', url, true);\n            }\n            if (typeof headers === 'object') {\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n            xhr.send(typeof options.body === 'undefined' ? null : options.body);\n        });\n    };\n    RequestService.prototype.fetchJSON = function (url, options) {\n        if (!options) {\n            options = {};\n        }\n        if (!options.headers) {\n            options.headers = {};\n        }\n        if (!options.headers['Content-Type']) {\n            options.headers['Content-Type'] = 'application/json';\n        }\n        return this.fetch(url, options).then(function (result) {\n            return JSON.parse(result);\n        });\n    };\n    return RequestService;\n}(Service_1.Service));\nexports.RequestService = RequestService;\n\n},{\"../lib/Service\":8}],20:[function(require,module,exports){\n\"use strict\";\nvar ROOMLE_TYPE;\n(function (ROOMLE_TYPE) {\n    ROOMLE_TYPE[ROOMLE_TYPE[\"ITEM\"] = 0] = \"ITEM\";\n    ROOMLE_TYPE[ROOMLE_TYPE[\"CONFIGURATION\"] = 1] = \"CONFIGURATION\";\n    ROOMLE_TYPE[ROOMLE_TYPE[\"PLAN\"] = 2] = \"PLAN\";\n    ROOMLE_TYPE[ROOMLE_TYPE[\"CONFIGURABLE_ITEM\"] = 3] = \"CONFIGURABLE_ITEM\";\n})(ROOMLE_TYPE = exports.ROOMLE_TYPE || (exports.ROOMLE_TYPE = {}));\nvar RoomleTypeService = (function () {\n    function RoomleTypeService() {\n    }\n    // TYPES ARE FROM OUTSIDE CONVERT THEM TO ENUM BECAUSE \"item\" is nicer than \"0\"\n    RoomleTypeService.convertTypeToEnum = function (type) {\n        if (type === 'item') {\n            return ROOMLE_TYPE.ITEM;\n        }\n        if (type === 'configuration') {\n            return ROOMLE_TYPE.CONFIGURATION;\n        }\n        if (type === 'plan') {\n            return ROOMLE_TYPE.PLAN;\n        }\n        if (type === 'configurable-item') {\n            return ROOMLE_TYPE.CONFIGURABLE_ITEM;\n        }\n        return null;\n    };\n    RoomleTypeService.convertRoomleType = function (type) {\n        if (type === ROOMLE_TYPE.ITEM) {\n            return 'item';\n        }\n        if (type === ROOMLE_TYPE.CONFIGURATION) {\n            return 'configuration';\n        }\n        if (type === ROOMLE_TYPE.PLAN) {\n            return 'plan';\n        }\n        if (type === ROOMLE_TYPE.CONFIGURABLE_ITEM) {\n            return 'configurable-item';\n        }\n        return null;\n    };\n    return RoomleTypeService;\n}());\nexports.RoomleTypeService = RoomleTypeService;\n\n},{}],21:[function(require,module,exports){\n\"use strict\";\nvar SettingsService = (function () {\n    function SettingsService(settings) {\n        this.settings = settings;\n    }\n    SettingsService.setDefault = function (settings, key, defaultValue) {\n        var toCheck = settings;\n        var keys = key.split('.');\n        var keysLength = keys.length - 1; // LAST ONE IS SET OUTSIDE THE LOOP\n        for (var i = 0; i < keysLength; i++) {\n            if (!toCheck[keys[i]]) {\n                toCheck[keys[i]] = {};\n            }\n            toCheck = toCheck[keys[i]];\n        }\n        if (toCheck[keys[keysLength]] === undefined) {\n            toCheck[keys[keysLength]] = defaultValue;\n        }\n    };\n    SettingsService.setDeeplinkTranslation = function (settings, linkType, translation) {\n        SettingsService.setDefault(settings, 'translations.' + linkType + '.heading', translation.heading);\n        SettingsService.setDefault(settings, 'translations.' + linkType + '.hint.ios', translation.hint.ios);\n        SettingsService.setDefault(settings, 'translations.' + linkType + '.hint.android', translation.hint.android);\n        SettingsService.setDefault(settings, 'translations.' + linkType + '.hint.desktop', translation.hint.desktop);\n    };\n    SettingsService.init = function (settings) {\n        if (!(this._instance instanceof SettingsService)) {\n            SettingsService.setDefault(settings, 'web.baseUrl', 'https://www.roomle.com/app/');\n            SettingsService.setDefault(settings, 'viewr.baseUrl', 'https://www.roomle.com/');\n            SettingsService.setDefault(settings, 'ios.baseUrl', 'https://www.roomle.com/');\n            SettingsService.setDefault(settings, 'dataSelector.type', 'data-rml-type');\n            SettingsService.setDefault(settings, 'dataSelector.id', 'data-rml-id');\n            SettingsService.setDefault(settings, 'dataSelector.action', 'data-rml-action');\n            SettingsService.setDefault(settings, 'planId', '8a708083560ca6cf01560cd7361a014a');\n            SettingsService.setDefault(settings, 'createPopUp', true);\n            SettingsService.setDefault(settings, 'showBackButton', true);\n            SettingsService.setDefault(settings, 'html.containerClass', 'roomle-buttons');\n            SettingsService.setDefault(settings, 'html.containerType', 'div');\n            SettingsService.setDefault(settings, 'html.buttonsContainer', 'ul');\n            SettingsService.setDefault(settings, 'html.buttonElement', 'li');\n            SettingsService.setDefault(settings, 'css.buttons.position', 'absolute');\n            SettingsService.setDefault(settings, 'css.buttons.top', '0');\n            SettingsService.setDefault(settings, 'css.buttons.right', '0');\n            SettingsService.setDefault(settings, 'css.buttons.line-height', 'normal');\n            SettingsService.setDefault(settings, 'css.buttons.visibility', 'visible !important');\n            SettingsService.setDefault(settings, 'css.item.position', 'relative');\n            SettingsService.setDefault(settings, 'callback', {});\n            SettingsService.setDefault(settings, 'callback.button', {});\n            SettingsService.setDefault(settings, 'popUpSelector', 'data-rml-deeplink-popup-container');\n            SettingsService.setDefault(settings, 'callback.booted', function () {\n            });\n            SettingsService.setDefault(settings, 'translations.errors.deeplinkcreate', 'Error creating deeplink');\n            var hint = ''; //'This feature is not available on your platform. ';\n            var androidHint = hint + 'Enter the following link into the browser of your desktop device';\n            var iosHint = hint + 'Enter the following link into the browser of your iOS device';\n            this.setDeeplinkTranslation(settings, 'ar', {\n                heading: 'Visualize in AR',\n                hint: { ios: iosHint, android: null, desktop: null }\n            });\n            this.setDeeplinkTranslation(settings, 'add', {\n                heading: 'Add to plan',\n                hint: { ios: null, android: null, desktop: androidHint }\n            });\n            this.setDeeplinkTranslation(settings, 'configure', {\n                heading: 'Customize',\n                hint: { ios: null, android: null, desktop: androidHint }\n            });\n            this.setDeeplinkTranslation(settings, 'mark', {\n                heading: 'Favourite',\n                hint: { ios: null, android: null, desktop: null }\n            });\n            this.setDeeplinkTranslation(settings, 'trigger', {\n                heading: 'Trigger',\n                hint: { ios: null, android: null, desktop: null }\n            });\n            this.setDeeplinkTranslation(settings, 'visualize', {\n                heading: 'Visualize',\n                hint: { ios: null, android: androidHint, desktop: null }\n            });\n            this.setDeeplinkTranslation(settings, 'vr', {\n                heading: 'View in VR',\n                hint: { ios: iosHint, android: '', desktop: '' }\n            });\n            this.setDeeplinkTranslation(settings, 'start_now', {\n                heading: 'Start planning now',\n                hint: { ios: iosHint, android: '', desktop: '' }\n            });\n            this._instance = new this(settings);\n        }\n        return this._instance;\n    };\n    SettingsService.getInstance = function () {\n        return this._instance;\n    };\n    Object.defineProperty(SettingsService, \"settings\", {\n        get: function () {\n            return SettingsService.getInstance().settings;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SettingsService;\n}());\nexports.SettingsService = SettingsService;\n\n},{}],22:[function(require,module,exports){\n\"use strict\";\nvar EnumEx = (function () {\n    function EnumEx() {\n    }\n    EnumEx.getNamesAndValues = function (e) {\n        return this.getNames(e).map(function (n) { return { name: n, value: e[n] }; });\n    };\n    EnumEx.getNames = function (e) {\n        return this.getObjValues(e).filter(function (v) { return typeof v === 'string'; });\n    };\n    EnumEx.getValues = function (e) {\n        return this.getObjValues(e).filter(function (v) { return typeof v === 'number'; });\n    };\n    EnumEx.getObjValues = function (e) {\n        return Object.keys(e).map(function (k) { return e[k]; });\n    };\n    return EnumEx;\n}());\nexports.EnumEx = EnumEx;\n\n},{}]},{},[9]);\n"]}