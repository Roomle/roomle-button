!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return r(i?i:e)},d,d.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";var n=e("./controllers/Controllers"),r=e("./services/SettingsService"),o=e("./services/EventHandlerService"),s=e("./services/ButtonsService"),a=e("./services/DomBuilderService"),c=e("./services/MobileRedirectService"),l=e("./services/MobileDetectService"),d=e("./services/RoomleTypeService"),u=e("./services/ImagesService"),p=e("./services/TrackingService"),v=function(){function e(e){this.domBuilder=null,this.trackingService=null,this.imagesService=null,this.eventHandler=null,this.mobileRedirectService=null,this.mobileDetectService=null,r.SettingsService.init(e),this.domBuilder=a.DomBuilderService.inject(),this.trackingService=p.TrackingService.inject(),this.imagesService=u.ImagesService.inject(),this.eventHandler=o.EventHandlerService.inject(),this.mobileRedirectService=c.MobileRedirectService.inject(),this.mobileDetectService=l.MobileDetectService.inject(),this.trackingService.trackGA("Init"),this.imagesService.preloadImages(),this._addCSS(),this._boot()}return e.prototype._addCSS=function(){var e="rml-button-lib",t=document.getElementById(e);if(t){var i=document.head||document.getElementsByTagName("head")[0],n=t.getAttribute("src"),r=n.replace(/\.js/g,".css");r&&r.length>1&&"j"===r[0]&&"s"===r[1]?(r=r.substr(2),r="css"+r):r=r.replace(/\/js\//g,"/css/");var o=document.createElement("link");o.href=r,o.rel="stylesheet",o.media="all",o.setAttribute("integrity","sha256-yYVYMuwTZyxCoZYeaJXWtZ8u2kz6Soq77Uc/6cAhkJQ="),i.appendChild(o)}},e.prototype._setupClickListener=function(e){var t=this;e.addEventListener("click",function(e){t.eventHandler.handle(e)})},e.prototype._boot=function(){var e=n,t=document.body;if(this.domBuilder.addCSS(),r.SettingsService.settings.container){var i=document.body.querySelectorAll(r.SettingsService.settings.container);i.length&&(t=i[0])}r.SettingsService.settings.createPopUp&&this.domBuilder.buildPopUp(t),this._setupClickListener(t);var o=r.SettingsService.settings.selector;for(var s in e)if(e.hasOwnProperty(s)){if("RoomleController"===s&&"lib"===r.SettingsService.settings.mode)continue;var a=e[s];"function"==typeof a.parse&&a.parse(o,t)}},e.prototype.openCustomPopUp=function(e,t,i){var n=this;this.domBuilder.buildCustomPopUp(t,i),this.trackingService.trackGA("OpenCustomPopUp"),setTimeout(function(){n.eventHandler.dispatchOpenPopUp(e)},1)},e.prototype.dispatchClick=function(e,t,i,n,r){void 0===r&&(r=null),this.trackingService.trackGAInteraction("DispatchClick:",i,n),this.eventHandler.dispatch(e,t,i,s.ButtonsService.convertButtonTypeToEnum(n),r)},e.prototype.getDomLinkFor=function(e,t,i,n){void 0===n&&(n=!1);var r=d.RoomleTypeService.convertTypeToEnum(i),o=s.ButtonsService.convertButtonTypeToEnum(e),a=this.mobileDetectService.generateLink(t,r,o),c={isHighlighted:n,buildAnyway:!0};return this.trackingService.trackGAInteraction("GetDomLinkFor:",t,e),this.domBuilder.buildLink(a,c)},e.prototype.appendButtons=function(e,t,i){var n=this;this.trackingService.trackGA("AppendButtons");var r=this.getLinks(t,i);r.forEach(function(t){e.appendChild(n.domBuilder.buildLink(t))})},e.prototype.execDeeplink=function(e,t,i,n,r){void 0===n&&(n=!1),void 0===r&&(r=null);var o=d.RoomleTypeService.convertTypeToEnum(t),a=s.ButtonsService.convertButtonTypeToEnum(i),c=this.mobileDetectService.generateLink(e,o,a);if(this.trackingService.trackGAInteraction("ExecDeeplink:",e,i),c.alternate){this.trackingService.trackGAInteraction("ExecDeeplink:Alternate:",e,i);var l=document.createEvent("Event");l.initEvent("execDeeplink",!0,!0),this.eventHandler.dispatch(l,t,e,s.BUTTON_TYPE.TRIGGER,i,n)}else this.trackingService.trackGAInteraction("ExecDeeplink:Regular:",e,i),this.mobileRedirectService.redirect(c,n,r)},e.prototype.getLinks=function(e,t,i){return void 0===i&&(i=null),this.trackingService.trackGAInteraction("GetLinks:",e),this.mobileDetectService.getLinks(e,d.RoomleTypeService.convertTypeToEnum(t),i)},e.getInstance=function(t){var i=this;if(this._instance instanceof e||(this._instance=new this(t)),!window.RoomleButtonInstance){var n=Object.getPrototypeOf(this._instance),o={},s=function(e){e&&n.hasOwnProperty(e)&&"_"!==e[0]&&(o[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i._instance[e].apply(i._instance,t)})};for(var a in n)s(a);window.RoomleButtonInstance=o,r.SettingsService.settings.callback.booted()}return this._instance},e}();i.RoomleButton=v},{"./controllers/Controllers":4,"./services/ButtonsService":10,"./services/DomBuilderService":12,"./services/EventHandlerService":13,"./services/ImagesService":15,"./services/MobileDetectService":16,"./services/MobileRedirectService":17,"./services/RoomleTypeService":19,"./services/SettingsService":20,"./services/TrackingService":21}],2:[function(e,t,i){"use strict";var n=e("./Environments"),r=function(){function e(){}return e.settings=function(){var t="public/libraries/roomle-ga/ga.html",i={rapi:"api.test.roomle.com/v2",protocol:"https://",rmlco:"",shortlink:function(t,i,r,o){return void 0===o&&(o=null),e.env!==n.Environments.TEST&&o?"http://rml.co/"+o+"/"+r:window.location.host+"/deeplink?id="+i+"&type="+t+"&button="+r},gaUrl:"https://test.roomle.com/"+t};switch(e.env!==n.Environments.TEST&&(i.rapi="api.roomle.com/v2"),e.env){case n.Environments.ALPHA:i.gaUrl="https://alpha.roomle.com/"+t;break;case n.Environments.PRODUCTION:i.gaUrl="https://www.roomle.com/"+t}return window.location.href.indexOf("0.0.0.0")!==-1&&(i.gaUrl="http://0.0.0.0:4949/ga.html"),i.rmlco=i.protocol+i.rapi+"/shortIds",i},Object.defineProperty(e,"env",{get:function(){return this.envIndicator.substring(3,this.envIndicator.length-3)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"config",{get:function(){return e.settings()},enumerable:!0,configurable:!0}),e}();r.envIndicator="###production###",i.Environment=r},{"./Environments":3}],3:[function(e,t,i){"use strict";var n=function(){function e(){}return e}();n.PRODUCTION="production",n.TEST="test",n.ALPHA="alpha",i.Environments=n},{}],4:[function(e,t,i){"use strict";var n=e("./RoomleController");i.RoomleController=n.RoomleController;var r=e("./PopupController");i.PopupController=r.PopupController},{"./PopupController":5,"./RoomleController":6}],5:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Controller"),o=e("../services/SettingsService"),s=e("../services/EventHandlerService"),a=e("../services/DomBuilderService"),c=e("../services/ImagesService"),l=e("../services/TrackingService"),d=function(e){function t(t){var i=e.call(this,t)||this;return i.eventHandlerService=s.EventHandlerService.inject(),i.domBuilderService=a.DomBuilderService.inject(),i.imagesService=c.ImagesService.inject(),i.trackingService=l.TrackingService.inject(),o.SettingsService.settings.createPopUp?(i.eventHandlerService.subscribe(s.EVENT_TYPES.TRIGGER,i.openPopup.bind(i)),i.eventHandlerService.subscribe(s.EVENT_TYPES.POP_UP_OPEN,i.simpleOpen.bind(i)),i.eventHandlerService.subscribe(s.EVENT_TYPES.POP_UP_CLOSE,i.closePopup.bind(i)),i.$(".rml-md-overlay")[0].addEventListener("click",function(){return i.closePopup()}),i.$(".rml-popup--close")[0].addEventListener("click",function(){return i.closePopup()}),o.SettingsService.settings.showBackButton?i.$(".rml-popup--back")[0].addEventListener("click",function(){return i.back()}):i.$(".rml-popup--back")[0].classList.add("rml-popup--back__hide"),i):i}return n(t,e),t.prototype.closePopup=function(){var e=this.$(".rml-popup")[0].classList;if(this.trackingService.trackGAInteraction("ClosePopUp:",this.id),e.contains("rml-md-show")){e.remove("rml-md-show");var t=this.$(".rml-popup--back")[0];t.classList.remove("rml-popup--back__show"),this.unfreezeScrolling();var i=document.querySelectorAll("["+o.SettingsService.settings.popUpSelector+"]");if(i[0].removeAttribute("data-rml-popup-item-id"),"function"==typeof o.SettingsService.settings.callback.popupClose){var n=this.id?this.id:"CUSTOM",r=this.type?this.type:"CUSTOM";o.SettingsService.settings.callback.popupClose(n,r)}}else e.add("rml-md-show"),this.freezeScrolling()},t.prototype.back=function(){var e=this.$(".rml-deeplink--slider")[0];e.classList.remove("rml-deeplink__hint");var t=this.$(".rml-deeplink__hint-container")[0];t.innerHTML="";var i=this.$(".rml-popup--back")[0];i.classList.remove("rml-popup--back__show");var n=this.$(".rml-deeplink--hint");if(n.length){var r=n[0];r.classList.remove("rml-hint__show")}},t.prototype.simpleOpen=function(e,t,i){e.preventDefault(),this.id=t,this.type=i;var n=document.querySelectorAll("["+o.SettingsService.settings.popUpSelector+"]");n[0].setAttribute("data-rml-popup-item-id",this.id);var r=n[0].querySelectorAll(".rml-md-modal");return r[0].classList.contains("rml-md-show")?r[0].classList.remove("rml-md-show"):r[0].classList.add("rml-md-show"),this.freezeScrolling(),"function"==typeof o.SettingsService.settings.callback.popupOpen&&o.SettingsService.settings.callback.popupOpen(t?t:"CUSTOM",i?i:"CUSTOM"),r[0]},t.prototype.openPopup=function(e,t,i,n,r){var s=this;this.trackingService.trackGAInteraction("OpenPopUp:",t);var a=this.simpleOpen(e,t,i),c=a.querySelectorAll(".rml-generated-content");c[0].innerHTML="";var l=document.createElement("div");l.classList.add("rml-deeplink--slider"),l.classList.add("rml-deeplink--links");var d=document.createElement("div");d.classList.add("rml-deeplink--slide"),d.classList.add("rml-deeplink--overview");var u=document.createElement("div");u.classList.add("rml-deeplink--slide"),u.classList.add("rml-deeplink--alternate"),n.forEach(function(e){var t=e.type===r,i=s.domBuilderService.buildLink(e,{isHighlighted:t,slideMode:!0,clickedHint:function(){u.innerHTML="";var t=document.createElement("div");t.classList.add("rml-deeplink__hint-container");var n=document.createElement("div"),r=document.createElement("div");n.classList.add("rml-deeplink__hint-img"),r.classList.add("rml-deeplink__hint-link");var a=document.createElement("img"),c=s.imagesService.images[e.alternate];a.setAttribute("src",c),n.appendChild(a),t.appendChild(n);var d=document.querySelector(".rml-popup--back");o.SettingsService.settings.showBackButton&&d.classList.add("rml-popup--back__show");var p=i.cloneNode(!0);r.appendChild(p),s.trackingService.trackGAInteraction("ClickedHint:",e.id,e.type),s.domBuilderService.addShortlink(r,e.roomleType,e.type,e.id),t.appendChild(r),u.appendChild(t),l.classList.contains("rml-deeplink__hint")?l.classList.remove("rml-deeplink__hint"):l.classList.add("rml-deeplink__hint");var v=r.querySelector(".rml-deeplink--hint");s.domBuilderService.addShortlink(r,e.roomleType,e.type,e.id),v.classList.add("rml-hint__show");var h=u.querySelector(".rml-deeplink--row");h.addEventListener("click",function(t){t.preventDefault();var i=r.querySelector("input");return i.select(),s.trackingService.trackGAInteraction("ClickedIntoShortUrl:",s.id,e.type),!1}),"function"==typeof o.SettingsService.settings.callback.clickedHint&&o.SettingsService.settings.callback.clickedHint(e.id,e.roomleType,e.type)}});i&&d.appendChild(i)}),l.appendChild(d),l.appendChild(u),c[0].appendChild(l)},t.prototype.freezeScrolling=function(){var e=document.querySelector("html"),t=document.body;if("fixed"!==e.style.position){var i=e.scrollTop?e.scrollTop:t.scrollTop;window.innerWidth>e.offsetWidth&&(e.style.overflowY="scroll"),e.style.width="100%",e.style.height="100%",e.style.position="fixed",e.style.top=-i+"px"}},t.prototype.unfreezeScrolling=function(){var e=document.querySelector("html"),t=document.body;if("fixed"===e.style.position){e.style.position="static";var i=-parseInt(e.style.top,10);e.scrollTop=i,t.scrollTop=i,e.style.position="",e.style.width="",e.style.height="",e.style.top="",e.style.overflowY=""}},t}(r.Controller);d.selector="[data-rml-deeplink-popup-container]",i.PopupController=d},{"../lib/Controller":7,"../services/DomBuilderService":12,"../services/EventHandlerService":13,"../services/ImagesService":15,"../services/SettingsService":20,"../services/TrackingService":21}],6:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Controller"),o=e("../services/DomBuilderService"),s=e("../services/RoomleTypeService"),a=e("../services/SettingsService"),c=function(e){function t(t){var i=e.call(this,t)||this;if(i.id=null,i.type=null,i.domBuilder=o.DomBuilderService.inject(),t){var n=a.SettingsService.settings.dataSelector.id,r=a.SettingsService.settings.dataSelector.type;i.id=t.getAttribute(n),i.type=s.RoomleTypeService.convertTypeToEnum(t.getAttribute(r)),null!==i.type&&i.id&&i.addButtons(i.type)}return i}return n(t,e),t.prototype.addButtons=function(e){if(!a.SettingsService.settings.createNoButtons){var t=this.$();if(t){var i=this.domBuilder.getButtons(e);t.appendChild(i)}}},t}(r.Controller);i.RoomleController=c},{"../lib/Controller":7,"../services/DomBuilderService":12,"../services/RoomleTypeService":19,"../services/SettingsService":20}],7:[function(e,t,i){"use strict";var n=function(){function e(e){this._element=e}return e.prototype.$=function(e){if(!(this._element instanceof Element))throw new Error("This controller has no element!");return e?this._element.querySelectorAll(e):this._element},e.prototype.getControllersByClass=function(t){for(var i=e._instances,n=[],r=0,o=i.length;r<o;r++){var s=i[r];s instanceof t&&n.push(s)}return n},e.beforeInstantiating=function(e){},e.afterInstantiating=function(e,t){},e.parse=function(t,i){if(void 0===i&&(i=document.body),"string"==typeof this.selector&&this.selector.length)t=this.selector;else if(!t)return;var n=i.querySelectorAll(t);this.beforeInstantiating(n);for(var r=0;r<n.length;r++){var o=n[r],s=/^function\s+([\w\$]+)\s*\(/.exec(this.toString())[1];s=s.toLocaleLowerCase(),o.getAttribute(e.PARSE_ID_ATTRIBUTE+"-"+s)||(o.setAttribute(e.PARSE_ID_ATTRIBUTE+"-"+s,Math.floor(10*Math.random()+1)*Date.now()+""),e._instances.push(new this(o)))}this.afterInstantiating(n,e._instances)},e}();n._instances=[],n.PARSE_ID_ATTRIBUTE="data-parse-id",i.Controller=n},{}],8:[function(e,t,i){"use strict";var n=function(){function e(){}return e.getInstance=function(){return this._instance instanceof e||(this._instance=new this),this._instance},e.inject=function(){return this.getInstance()},e}();i.Service=n},{}],9:[function(e,t,i){"use strict";var n=e("./services/MobileDetectService"),r=e("./RoomleButton"),o=n.MobileDetectService.inject();o.isIOS();var s=window.RoomleButtonSettings?window.RoomleButtonSettings:{};if(window.Promise)r.RoomleButton.getInstance(s);else{var a="rml-button-lib",c=document.getElementById(a),l=c.getAttribute("src"),d=document.createElement("script"),u=l.slice(0,l.lastIndexOf("/"));d.onload=function(){return r.RoomleButton.getInstance(s)},d.onerror=function(e){return r.RoomleButton.getInstance(s)},d.async=!0,d.src=u+"/es6-promise.min.js",d.setAttribute("type","text/javascript"),document.body.appendChild(d)}},{"./RoomleButton":1,"./services/MobileDetectService":16}],10:[function(e,t,i){"use strict";var n,r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},o=e("../lib/Service"),s=e("../utils/EnumEx");!function(e){e[e.TRIGGER=0]="TRIGGER",e[e.ADD=1]="ADD",e[e.VISUALIZE=2]="VISUALIZE",e[e.CONFIGURE=3]="CONFIGURE",e[e.AR=4]="AR",e[e.MARK=5]="MARK",e[e.START_NOW=6]="START_NOW",e[e.VR=7]="VR"}(n=i.BUTTON_TYPE||(i.BUTTON_TYPE={}));var a=function(e){function t(){var t=e.call(this)||this;return t.availableButtons=s.EnumEx.getValues(n),t}return r(t,e),t.convertButtonTypeToEnum=function(e){return"trigger"===e?n.TRIGGER:"add"===e?n.ADD:"ar"===e?n.AR:"configure"===e?n.CONFIGURE:"mark"===e?n.MARK:"visualize"===e?n.VISUALIZE:"vr"===e?n.VR:"start_now"===e?n.START_NOW:void 0},t.convertButtonType=function(e){return e===n.TRIGGER?"trigger":e===n.ADD?"add":e===n.AR?"ar":e===n.CONFIGURE?"configure":e===n.MARK?"mark":e===n.VISUALIZE?"visualize":e===n.VR?"vr":e===n.START_NOW?"start_now":void 0},t}(o.Service);i.ButtonsService=a},{"../lib/Service":8,"../utils/EnumEx":22}],11:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},t.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)},t.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)},t}(r.Service);i.ConsoleService=o},{"../lib/Service":8}],12:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=e("./MobileDetectService"),s=e("./SettingsService"),a=e("./ButtonsService"),c=e("./RoomleTypeService"),l=e("./IconsService"),d=e("./ConsoleService"),u=e("./MobileRedirectService"),p=e("../controllers/PopupController"),v=e("../services/RequestService"),h=e("../config/Environment"),m=e("./TrackingService"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.trackingService=m.TrackingService.inject(),t.mobileDetect=o.MobileDetectService.inject(),t.buttonsService=a.ButtonsService.inject(),t.iconsService=l.IconsService.inject(),t.mobileRedirectService=u.MobileRedirectService.inject(),t.requestService=v.RequestService.inject(),t.elementCache={},t.buttonsCache={},t.shortLinkCache={},t.waitingForShortLink=!1,t}return n(t,e),t.prototype.createCSS=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t+=i+":"+e[i]+";");return t},t.prototype.addCSS=function(){if(!s.SettingsService.settings.createNoButtons){var e=this.createCSS(s.SettingsService.settings.css.buttons);e="."+s.SettingsService.settings.html.containerClass+"{"+e+"visibility: hidden;}";var t=this.createCSS(s.SettingsService.settings.css.item);t=s.SettingsService.settings.selector+"{"+t+"}";var i=".rml-md-modal{visibility:hidden;}",n=e+t+i,r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.appendChild(document.createTextNode(n)),r.appendChild(o)}},t.prototype.build=function(e,t){if(!this.elementCache[e]){var i=document.createDocumentFragment(),n=document.createElement(s.SettingsService.settings.html.buttonElement),r=a.ButtonsService.convertButtonType(e);n.setAttribute(s.SettingsService.settings.dataSelector.action,r),i.appendChild(n),this.elementCache[e]=i}return this.elementCache[e].cloneNode(!0)},t.prototype.buildTrigger=function(){var e=a.BUTTON_TYPE.TRIGGER,t=a.ButtonsService.convertButtonType(e);if(!this.elementCache[e]){var i=document.createDocumentFragment(),n=document.createElement(s.SettingsService.settings.html.buttonElement);n.setAttribute(s.SettingsService.settings.dataSelector.action,t);var r=this.iconsService.create(t);n.appendChild(r),i.appendChild(n),this.elementCache[e]=i}return this.elementCache[e].cloneNode(!0)},t.prototype.buildPopUpDom=function(){var e=document.body.querySelectorAll("[data-rml-deeplink-popup-container]");if(e&&e.length>0)return e[0];var t=document.createElement("div");t.setAttribute("data-rml-deeplink-popup-container",""),t.classList.add("rml-btn");var i=document.createElement("div");i.classList.add("rml-md-modal"),i.classList.add("rml-popup"),i.classList.add("rml-md-effect-1"),i.setAttribute("data-rml-deeplink-popup","");var n=document.createElement("div");n.classList.add("rml-md-content");var r=document.createElement("div");r.classList.add("rml-popup--close");var o=document.createElement("div");o.classList.add("rml-popup--back");var s=document.createElement("div");s.classList.add("rml-generated-content");var a=document.createElement("div");return a.classList.add("rml-md-overlay"),i.appendChild(n),n.appendChild(r),n.appendChild(o),n.appendChild(s),t.appendChild(i),t.appendChild(a),t},t.prototype.buildCustomPopUp=function(e,t){void 0===t&&(t=document.body);var i=this.buildPopUpDom(),n=i.querySelectorAll(".rml-md-content")[0],r=n.querySelector(".rml-generated-content");r.innerHTML="",e&&r.appendChild(e);var o=document.body.querySelectorAll("[data-rml-deeplink-popup-container]");if(!o||0===o.length){t.appendChild(i);var a=s.SettingsService.settings.selector,c=document.body;p.PopupController.parse(a,c)}},t.prototype.buildPopUp=function(e){void 0===e&&(e=document.body);var t=this.buildPopUpDom();e.appendChild(t)},t.prototype.buildAddToPlan=function(){return this.build(a.BUTTON_TYPE.ADD,"Plan")},t.prototype.buildVisualize=function(){return this.build(a.BUTTON_TYPE.VISUALIZE,"Visualize")},t.prototype.buildConfigure=function(){return this.build(a.BUTTON_TYPE.CONFIGURE,"Configure")},t.prototype.buildAR=function(){return this.build(a.BUTTON_TYPE.AR,"Augmented Reality")},t.prototype.buildMark=function(){return this.build(a.BUTTON_TYPE.MARK,"Mark")},t.prototype.buildVR=function(){return this.build(a.BUTTON_TYPE.VR,"Virtual Reality")},t.prototype.buildButtons=function(e){var t=this,i="";if(this.buttonsService.availableButtons.forEach(function(n){t.mobileDetect.generateLink("",e,n)&&(i+=n)}),!this.buttonsCache[i]){var n=document.createDocumentFragment(),r=document.createElement(s.SettingsService.settings.html.containerType);r.classList.add(s.SettingsService.settings.html.containerClass);var o=document.createElement(s.SettingsService.settings.html.buttonsContainer),c=!1;if(this.buttonsService.availableButtons.forEach(function(i){var n=t.mobileDetect.generateLink("",e,i);if(n){if(s.SettingsService.settings.showOnlyTrigger)return void(c=!0);if(i===a.BUTTON_TYPE.ADD){var r=t.buildAddToPlan();return o.appendChild(r),void(c=!0)}if(i===a.BUTTON_TYPE.AR){var l=t.buildAR();return o.appendChild(l),void(c=!0)}if(i===a.BUTTON_TYPE.CONFIGURE){var u=t.buildConfigure();return o.appendChild(u),void(c=!0)}if(i===a.BUTTON_TYPE.MARK){var p=t.buildMark();return o.appendChild(p),void(c=!0)}if(i===a.BUTTON_TYPE.VISUALIZE){var v=t.buildVisualize();return o.appendChild(v),void(c=!0)}if(i===a.BUTTON_TYPE.VR){var h=t.buildVR();return o.appendChild(h),void(c=!0)}d.ConsoleService.error('ButtonType "'+i+'" unknown')}}),c){var l=this.buildTrigger();o.insertBefore(l,o.firstChild),r.appendChild(o)}n.appendChild(r),this.buttonsCache[i]=n}return this.buttonsCache[i].cloneNode(!0)},t.prototype.getButtons=function(e){return this.buildButtons(e)},t.prototype.buildDeeplink=function(e,t){var i=1;e===c.ROOMLE_TYPE.CONFIGURATION&&(i=3),e!==c.ROOMLE_TYPE.CONFIGURABLE_ITEM&&e!==c.ROOMLE_TYPE.ITEM||(i=4);var n="anonymous",r=new Date,o="roomle_portal_v2",s=r.toISOString()+";"+n+";"+o;return s="03-"+window.btoa(s),this.requestService.fetchJSON(h.Environment.config.rmlco,{method:"POST",headers:{apiKey:"roomle_portal_v2",currentTenant:9,language:"en",locale:"en",token:s},body:{shortId:{type:i,referencedId:t}}})},t.prototype.isAvailableLink=function(e){return a.ButtonsService.convertButtonTypeToEnum(e)!==a.BUTTON_TYPE.MARK&&a.ButtonsService.convertButtonTypeToEnum(e)!==a.BUTTON_TYPE.START_NOW},t.prototype.createDeeplinkInput=function(e,t,i,n){var r=this;e.innerHTML="";var o=document.createElement("input");return o.setAttribute("type","text"),o.setAttribute("value",t),o.setAttribute("readonly","readonly"),o.addEventListener("click",function(e){e.stopImmediatePropagation(),e.preventDefault(),o.select(),r.trackingService.trackGAInteraction("ClickedIntoShortUrl:",i,n)}),e.appendChild(o),o},t.prototype.createCopySvg=function(e,t,i,n){var r=this;if("function"==typeof document.execCommand){var o=this.iconsService.createCopy();o.classList.add("rml-clickable"),o.classList.add("rml-fake-link"),o.classList.add("rml-icons__copy"),o.addEventListener("click",function(){t.select();try{r.trackingService.trackGAInteraction("ClickedCopyCommand:",i,n),document.execCommand("copy")}catch(e){r.trackingService.trackGAInteraction("ClickedCopyCommandFailed:",i,n)}}),e.appendChild(o)}},t.prototype.addShortlink=function(e,t,i,n){var r=this,o=e.querySelector(".rml-deeplink--link"),a=!1;o||(o=document.createElement("span"),a=!0),o.classList.add("rml-deeplink--link"),o.classList.add("rml-deeplink--heading"),o.classList.add("text--red"),a&&e.appendChild(o);var l=t+":"+n,d=this.shortLinkCache[l];if(d){var u=this.createDeeplinkInput(o,d,n,i);this.createCopySvg(o,u,n,i)}else{if(this.waitingForShortLink)return;this.waitingForShortLink=!0;var p=document.createElement("span");p.classList.add("rml-spinner"),p.classList.add("rml-spinner--white"),o.appendChild(p),this.buildDeeplink(t,n).then(function(e){var s=h.Environment.config.shortlink(c.RoomleTypeService.convertRoomleType(t),n,i,e.shortId.shortId),a=r.createDeeplinkInput(o,s,n,i);r.createCopySvg(o,a,n,i),r.shortLinkCache[l]=s,r.waitingForShortLink=!1},function(){r.waitingForShortLink=!1,o.removeChild(p),o.textContent=s.SettingsService.settings.translations.errors.deeplinkcreate})}},t.prototype.buildLink=function(e,t){var i=this;void 0===t&&(t={});var n=t.isHighlighted,r=void 0!==n&&n,o=t.buildAnyway,l=void 0!==o&&o,d=t.slideMode,u=void 0!==d&&d,p=t.clickedHint,v=void 0===p?function(){}:p;if(this.isAvailableLink(e.type)||l){var h=document.createElement("a");h.classList.add("rml-deeplink--row"),a.ButtonsService.convertButtonTypeToEnum(e.type)===a.BUTTON_TYPE.CONFIGURE&&s.SettingsService.settings.web.configuratorSameWindow||h.setAttribute("target","_blank"),h.setAttribute("href",e.link);var m=document.createElement("span");m.classList.add("rml-deeplink--text"),m.classList.add("rml-deeplink--heading"),m.textContent=s.SettingsService.settings.translations[e.type].heading;var f=document.createElement("span");f.classList.add("rml-deeplink--icon");var S=this.iconsService.create(e.type);f.appendChild(S),h.appendChild(m),h.appendChild(f);var g=s.SettingsService.settings.callback.button[e.type];if(h.addEventListener("click",function(){var t=e.type,n=t.charAt(0).toUpperCase()+t.substr(1);i.trackingService.trackGAInteraction(n+"Clicked:",e.id)}),g&&h.addEventListener("click",function(){g(e.id,c.RoomleTypeService.convertRoomleType(e.roomleType),e.type)}),e.alternate){var y=document.createElement("span");y.classList.add("rml-deeplink--hint"),y.textContent=s.SettingsService.settings.translations[e.type].hint[e.alternate],h.appendChild(y),h.addEventListener("click",function(t){return t.preventDefault(),u?y.classList.add("rml-hint__slide"):y.classList.contains("rml-hint__show")?y.classList.remove("rml-hint__show"):(i.addShortlink(y,e.roomleType,e.type,e.id),y.classList.add("rml-hint__show")),v(),!1}),r&&setTimeout(function(){y.classList.add("rml-hint__show"),u?(y.classList.add("rml-hint__slide"),v()):i.addShortlink(y,e.roomleType,e.type,e.id)},1)}else"desktop"!==e.os&&this.mobileRedirectService.createDeeplinkFor(h,e.os);return h}},t}(r.Service);i.DomBuilderService=f},{"../config/Environment":2,"../controllers/PopupController":5,"../lib/Service":8,"../services/RequestService":18,"./ButtonsService":10,"./ConsoleService":11,"./IconsService":14,"./MobileDetectService":16,"./MobileRedirectService":17,"./RoomleTypeService":19,"./SettingsService":20,"./TrackingService":21}],13:[function(e,t,i){"use strict";var n,r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},o=e("../lib/Service"),s=e("./RoomleTypeService"),a=e("./ButtonsService"),c=e("./SettingsService"),l=e("./MobileDetectService");!function(e){e[e.TRIGGER=0]="TRIGGER",e[e.POP_UP_OPEN=1]="POP_UP_OPEN",e[e.POP_UP_CLOSE=2]="POP_UP_CLOSE"}(n=i.EVENT_TYPES||(i.EVENT_TYPES={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mobileDetectService=l.MobileDetectService.inject(),t.triggerCallbacks=[],t.openPopUpCallbacks=[],t}return r(t,e),t.prototype.subscribe=function(e,t){e===n.TRIGGER&&this.triggerCallbacks.push(t),e===n.POP_UP_OPEN&&this.openPopUpCallbacks.push(t)},t.prototype.findSelector=function(e,t,i,n){if(void 0===i&&(i=0),void 0===n&&(n=20),n===i)return null;if(e.matches&&e.matches(t))return e;if(e.msMatchesSelector&&e.msMatchesSelector(t))return e;var r=e.parentElement||e.parentNode;return r?this.findSelector(r,t,i+1):null},t.prototype.dispatchOpenPopUp=function(e){this.openPopUpCallbacks.forEach(function(t){t(e)})},t.prototype.dispatch=function(e,t,i,n,r,o){void 0===r&&(r=null),void 0===o&&(o=!1);var l=a.ButtonsService.convertButtonType(n),d=this.mobileDetectService.getLinks(i,s.RoomleTypeService.convertTypeToEnum(t));if(n===a.BUTTON_TYPE.TRIGGER){var u=a.ButtonsService.convertButtonType(a.BUTTON_TYPE.TRIGGER),p=c.SettingsService.settings.callback[u];"function"==typeof p&&p(e,i,t,d,r,o),this.triggerCallbacks.forEach(function(n){n(e,i,t,d,r,o)})}var v=c.SettingsService.settings.callback[t];v&&v[l]&&"function"==typeof v[l]&&v[l](e,i,t,d,r,o)},t.prototype.getElement=function(e,t){var i=e.querySelectorAll("["+t+"]");return i&&0!==i.length||!e.hasAttribute(t)?i[0]:e},t.prototype.handle=function(e){var t=e.target||e.srcElement,i=this.findSelector(t,"["+c.SettingsService.settings.dataSelector.action+"]");if(i){var n=i.getAttribute(c.SettingsService.settings.dataSelector.action);if(n){var r=this.findSelector(t,c.SettingsService.settings.selector);if(!r)return;var o=this.getElement(r,c.SettingsService.settings.dataSelector.type),s=null,l=null;o&&(s=o.getAttribute(c.SettingsService.settings.dataSelector.type));var d=this.getElement(r,c.SettingsService.settings.dataSelector.id);d&&(l=d.getAttribute(c.SettingsService.settings.dataSelector.id)),this.dispatch(e,s,l,a.ButtonsService.convertButtonTypeToEnum(n))}}},t}(o.Service);i.EventHandlerService=d},{"../lib/Service":8,"./ButtonsService":10,"./MobileDetectService":16,"./RoomleTypeService":19,"./SettingsService":20}],14:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=e("./ButtonsService"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getSvg=function(e){e=e||{},e.width||(e.width="64"),e.height||(e.height="64");var i=document.createElementNS(t.SVG_NS,"svg");for(var n in e)i.setAttributeNS(null,n,e[n]);return i},t.prototype.getNode=function(e,i){var n=document.createElementNS(t.SVG_NS,e);for(var r in i)n.setAttributeNS(null,r,i[r]);return n},t.prototype.buildPlanIcon=function(e){var t=this.getSvg({viewBox:"0 0 50 50"}),i=this.getNode("path",{d:"M39.72,23.16,31,17.93h0l-.36-.22-5.13-3.07h0l-.36-.22a.33.33,0,0,0-.35,0l-.36.22h0l-13.87,8.3h0l-.36.22a.53.53,0,0,0,0,.85l.36.22h0l5.13,3.07h0l.36.22h0l8.38,5h0l.24.14.12.07a.33.33,0,0,0,.35,0L39.72,24a.53.53,0,0,0,0-.85Zm-5.09,2.4-3.34-2a.33.33,0,0,0-.35,0l-.36.22a.53.53,0,0,0,0,.85l2.8,1.68-8.43,5-7.49-4.48,2.89-1.73a.53.53,0,0,0,0-.85l-.18-.11h0l-.91-.54a.33.33,0,0,0-.35,0l-.36.22a.53.53,0,0,0,0,.85h0l-2.36,1.41L12,23.58l2.36-1.41,2.45,1.47a.34.34,0,0,0,.17,0,.34.34,0,0,0,.17,0l.36-.22a.53.53,0,0,0,0-.85l-1.91-1.14L25,15.82l4.24,2.54-7.85,4.7a.53.53,0,0,0,0,.85l.36.22a.33.33,0,0,0,.35,0l3.84-2.3,1.83,1.1a.34.34,0,0,0,.17,0,.34.34,0,0,0,.17,0l.36-.22a.53.53,0,0,0,0-.85l-1.3-.77,3.3-2,7.49,4.48Z"
});if(t.appendChild(i),e){var n=this.getNode("path",{d:"M37.29,33.15v2.48h-1.4V33.15H33.42v-1.4h2.47V29.29h1.4v2.46h2.47v1.4Z"});t.appendChild(n)}return t},t.prototype.buildAdd=function(){return this.buildPlanIcon(!0)},t.prototype.buildPlanNow=function(){return this.buildPlanIcon(!1)},t.prototype.buildAr=function(){var e=this.getSvg({viewBox:"0 0 50 50"}),t=this.getNode("path",{d:"M24.41,33.24h0c-5.22-.08-9.5-2.78-14.31-9a.75.75,0,0,1-.16-.46c0-.63,4.46-6.73,10.67-8.84,8.34-2.84,15,3,19.19,8.38a.75.75,0,0,1,.16.46c0,.45-.63,1.34-1.87,2.63a.75.75,0,0,1-1.09-1,13.24,13.24,0,0,0,1.3-1.52c-4.4-5.57-9-8.3-13.69-8.15-6.69.23-11.71,6.36-13,8.06,5.49,7,9.55,8,12.8,8a.75.75,0,0,1,0,1.5Z"}),i=this.getNode("path",{d:"M24.94,29.4a5.42,5.42,0,0,1-5.05-3.5,5.58,5.58,0,0,1,1.56-6.51,5.3,5.3,0,0,1,6.44-.3,5.66,5.66,0,0,1,2.34,6.39A.75.75,0,1,1,28.79,25a4.18,4.18,0,0,0-1.74-4.7,3.79,3.79,0,0,0-4.65.21,4.12,4.12,0,0,0-1.12,4.79,3.9,3.9,0,0,0,4,2.55.74.74,0,0,1,.81.69.75.75,0,0,1-.69.81Z"}),n=this.getNode("g"),r=this.getNode("path",{d:"M30.5,35.1,30,33.68H27.18L26.7,35.1H25.06l2.92-8h1.23l2.93,8Zm-1.87-5.65-1,2.92h2Z"}),o=this.getNode("path",{d:"M37.39,35.1l-1.57-3.2H34.69v3.2H33.13v-8h3.14a2.42,2.42,0,0,1,2.6,2.46,2.16,2.16,0,0,1-1.46,2.11L39.2,35.1Zm-1.22-6.62H34.69v2.12h1.48a1.06,1.06,0,1,0,0-2.12Z"});return n.appendChild(r),n.appendChild(o),e.appendChild(t),e.appendChild(i),e.appendChild(n),e},t.prototype.buildConfigure=function(){var e=this.getSvg({viewBox:"0 0 50 50"}),t=this.getNode("path",{d:"M34.67,10.9,28.9,8.22a1.87,1.87,0,0,0-2.48.91L16,31.42a1.86,1.86,0,0,0-.17.75L15.66,40a1.85,1.85,0,0,0,.53,1.34,1.9,1.9,0,0,0,1.35.57,1.86,1.86,0,0,0,1.23-.47l5.93-5.22a1.86,1.86,0,0,0,.46-.62L35.58,13.37A1.88,1.88,0,0,0,34.67,10.9ZM17.47,40.22l.14-7,4.91,2.55ZM32,16.94l-5.88-2.73,1.94-4.38L34,12.57Z"});return e.appendChild(t),e},t.prototype.buildMark=function(){var e=this.getSvg({viewBox:"0 0 50 50"}),t=this.getNode("path",{d:"M32.16,12.05A7.89,7.89,0,0,0,25,16.51,7.93,7.93,0,0,0,10,20C10,29.35,25,39.64,25,39.64s15-10.37,15-19.66A7.91,7.91,0,0,0,32.16,12.05Z"});return e.appendChild(t),e},t.prototype.buildCopy=function(){var e=this.getSvg({viewBox:"0 0 32 32"}),t=this.getNode("path",{d:"M28.681 11.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-11.5c-1.379 0-2.5 1.122-2.5 2.5v23c0 1.378 1.121 2.5 2.5 2.5h19c1.378 0 2.5-1.122 2.5-2.5v-15.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 9.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268v0zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-19c-0.271 0-0.5-0.229-0.5-0.5v-23c0-0.271 0.229-0.5 0.5-0.5 0 0 11.499-0 11.5 0v7c0 0.552 0.448 1 1 1h7v15.5z"}),i=this.getNode("path",{d:"M18.841 1.319c-1.612-1.182-2.393-1.319-2.841-1.319h-11.5c-1.378 0-2.5 1.121-2.5 2.5v23c0 1.207 0.86 2.217 2 2.45v-25.45c0-0.271 0.229-0.5 0.5-0.5h15.215c-0.301-0.248-0.595-0.477-0.873-0.681z"});return e.appendChild(t),e.appendChild(i),e},t.prototype.buildTrigger=function(){var e=this.getSvg({viewBox:"0 0 32.19 29.5"}),t=this.getNode("path",{d:"M21,22.36c-1.57,0-1.87,1.36-1.87,3s0.17,3,1.87,3,1.87-1.36,1.87-3S22.59,22.36,21,22.36Z",transform:"translate(-9 -15.26)"}),i=this.getNode("path",{d:"M31.1,22.36c-1.57,0-1.87,1.36-1.87,3s0.17,3,1.87,3S33,27,33,25.36,32.66,22.36,31.1,22.36Z",transform:"translate(-9 -15.26)"}),n=this.getNode("path",{d:"M26,15.26c-5.86,0-17,.73-17,3.48V31.89a1.16,1.16,0,0,0,.17.49c1,2.06,9.46,3,16.85,3,5.86,0,17-.73,17-3.48V18.74C43,16,31.86,15.26,26,15.26ZM21,30.11c-3.46,0-4.69-2.14-4.69-4.79S17.6,20.53,21,20.53s4.69,2.14,4.69,4.79S24.47,30.11,21,30.11Zm10.08,0c-3.46,0-4.69-2.14-4.69-4.79s1.28-4.79,4.69-4.79,4.69,2.14,4.69,4.79S34.55,30.11,31.1,30.11Z",transform:"translate(-9 -15.26)"}),r=this.getNode("path",{d:"M31.1,28.36c-1.7,0-1.87-1.36-1.87-3s0.3-3,1.87-3,1.87,1.36,1.87,3S32.8,28.36,31.1,28.36Z",transform:"translate(-9 -15.26)"}),o=this.getNode("path",{d:"M21,28.36c-1.7,0-1.87-1.36-1.87-3s0.3-3,1.87-3,1.87,1.36,1.87,3S22.72,28.36,21,28.36Z",transform:"translate(-9 -15.26)"});return e.appendChild(t),e.appendChild(i),e.appendChild(n),e.appendChild(r),e.appendChild(o),e},t.prototype.buildVisualize=function(){var e=this.getSvg({viewBox:"0 0 50 50"}),t=this.getNode("path",{d:"M25,34.59c-6.32,0-11.44-4.71-14.84-9.13a.75.75,0,0,1,0-.87c.24-.36,6-8.87,14.49-9.17C29.9,15.23,35,18.3,39.85,24.55A.74.74,0,0,1,40,25c0,.6-4.61,6.78-10.68,8.84A13.47,13.47,0,0,1,25,34.59ZM11.65,25c4.4,5.55,9,8.28,13.68,8.12,6.7-.23,11.74-6.38,13-8.08-4.4-5.55-9-8.28-13.69-8.12C17.93,17.14,12.91,23.28,11.65,25ZM25,30.49A5.49,5.49,0,1,1,30.38,25,5.45,5.45,0,0,1,25,30.49ZM25,21a4,4,0,1,0,3.91,4A4,4,0,0,0,25,21Z"});return e.appendChild(t),e},t.prototype.buildVr=function(){var e=this.getSvg({viewBox:"0 0 50 50"}),t=this.getNode("path",{d:"M37.88,16.24H12.18A2.16,2.16,0,0,0,10,18.4V31.6a2.16,2.16,0,0,0,2.16,2.16H20a1.54,1.54,0,0,0,1.46-.93l1.75-4.38a1.92,1.92,0,0,1,3.5.06l1.52,4.26a1.59,1.59,0,0,0,1.46,1h8.12A2.16,2.16,0,0,0,40,31.6V18.46A2.05,2.05,0,0,0,37.88,16.24ZM18.6,28.8a3.33,3.33,0,0,1-3.33-3.33,3.33,3.33,0,1,1,6.66,0A3.33,3.33,0,0,1,18.6,28.8Zm12.85,0a3.33,3.33,0,0,1-3.33-3.33,3.33,3.33,0,0,1,6.66,0A3.33,3.33,0,0,1,31.45,28.8Z"});return e.appendChild(t),e},t.prototype.create=function(e){var t=o.ButtonsService.convertButtonTypeToEnum(e);return t===o.BUTTON_TYPE.ADD?this.buildAdd():t===o.BUTTON_TYPE.AR?this.buildAr():t===o.BUTTON_TYPE.CONFIGURE?this.buildConfigure():t===o.BUTTON_TYPE.VISUALIZE?this.buildVisualize():t===o.BUTTON_TYPE.VR?this.buildVr():t===o.BUTTON_TYPE.TRIGGER?this.buildTrigger():t===o.BUTTON_TYPE.MARK?this.buildMark():t===o.BUTTON_TYPE.START_NOW?this.buildPlanNow():void 0},t.prototype.createCopy=function(){return this.buildCopy()},t}(r.Service);s.SVG_NS="http://www.w3.org/2000/svg",i.IconsService=s},{"../lib/Service":8,"./ButtonsService":10}],15:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.images={ios:"https://a.storyblok.com/f/4e779959c8/ios.png",android:"https://a.storyblok.com/f/1386db8cd0/android.png",desktop:"https://a.storyblok.com/f/cf5aa03c64/desktop.png"},t}return n(t,e),t.prototype.preloadImages=function(){var e=new Image,t=new Image,i=new Image;e.src=this.images.ios,t.src=this.images.android,i.src=this.images.desktop},t}(r.Service);i.ImagesService=o},{"../lib/Service":8}],16:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=e("./RoomleTypeService"),s=e("./ButtonsService"),a=e("./SettingsService"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isOSCached=null,t.isAndroidCached=null,t.isIPadCached=null,t.isSupportedMobileCached=null,t.buttonsService=s.ButtonsService.inject(),t}return n(t,e),t.prototype.isIOS=function(){return null!==this.isOSCached?this.isOSCached:/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!window.MSStream},t.prototype.isAndroid=function(){return null!==this.isAndroidCached?this.isAndroidCached:/Android/i.test(navigator.userAgent)&&!window.MSStream},t.prototype.isSupportedMobile=function(){return null!==this.isSupportedMobileCached?this.isSupportedMobileCached:this.isIOS()||this.isAndroid()},t.prototype.isIPad=function(){return null!==this.isIPadCached?this.isIPadCached:/iPad/i.test(navigator.userAgent)&&!window.MSStream},t.prototype.handlePlan=function(e,t,i){var n=s.ButtonsService.convertButtonType(i),r=t,o="roomle://3d/planId/"+e,c=a.SettingsService.settings.web.baseUrl+"editor/"+e;if(i===s.BUTTON_TYPE.VISUALIZE){var l="roomleviewer://plan/"+e;return this.isAndroid()?{type:n,alternate:null,link:l,os:"android",roomleType:r,id:e}:this.isIOS()?{type:n,alternate:null,link:o,os:"ios",roomleType:r,id:e}:{type:n,alternate:null,link:c,os:"desktop",roomleType:r,id:e}}if(i===s.BUTTON_TYPE.VR){var l="roomleviewer://vr/"+e;return this.isAndroid()?{type:n,alternate:null,link:l,os:"android",roomleType:r,id:e}:this.isIOS()?{type:n,alternate:null,link:l,os:"ios",roomleType:r,id:e}:{type:n,alternate:"ios",link:l,os:"desktop",roomleType:r,id:e}}if(i===s.BUTTON_TYPE.START_NOW){var l="roomleviewer://plan/"+e;return this.isAndroid()?{type:n,alternate:null,link:l,os:"android",roomleType:r,id:e}:this.isIOS()?{type:n,alternate:null,link:o,os:"ios",roomleType:r,id:e}:{type:n,alternate:null,link:c,os:"desktop",roomleType:r,id:e}}return null},t.prototype.createLinkForItemOrConfiguration=function(e,t,i,n){var r=t,c=s.ButtonsService.convertButtonType(i),l=n||t===o.ROOMLE_TYPE.CONFIGURABLE_ITEM?"catalogItemId":"configurationId",d=n||t===o.ROOMLE_TYPE.CONFIGURABLE_ITEM?"itemId[]":"configurationId[]";if(i===s.BUTTON_TYPE.ADD){var u=a.SettingsService.settings.web.baseUrl+"editor/"+a.SettingsService.settings.planId+"?"+d+"="+e,p="roomle://addToPlan/"+l+"/"+e+"?planId="+a.SettingsService.settings.planId;return this.isAndroid()?{type:c,alternate:"desktop",link:u,os:"android",roomleType:r,id:e}:this.isIOS()?null:{type:c,alternate:null,link:u,os:"desktop",roomleType:r,id:e}}if(i===s.BUTTON_TYPE.AR){var p="roomle://ar/"+l+"/"+e;return this.isAndroid()?{type:c,alternate:"ios",link:p,os:"android",roomleType:r,id:e}:this.isIOS()?{type:c,alternate:null,link:p,os:"ios",roomleType:r,id:e}:{type:c,alternate:"ios",link:p,os:"desktop",roomleType:r,id:e}}if(i===s.BUTTON_TYPE.CONFIGURE&&(t===o.ROOMLE_TYPE.CONFIGURATION||t===o.ROOMLE_TYPE.CONFIGURABLE_ITEM)){var v=t!==o.ROOMLE_TYPE.CONFIGURATION,u=a.SettingsService.settings.web.baseUrl+"configurator/"+e+(v?"?isItem=true":"");"string"==typeof a.SettingsService.settings.web.configuratorUrl&&(u=a.SettingsService.settings.web.configuratorUrl.replace("<[ID]>",e).replace("<[TYPE]>",o.RoomleTypeService.convertRoomleType(t)));var p="roomle://configuration/"+l+"/"+e;return this.isAndroid()?{type:c,alternate:"desktop",link:u,os:"android",roomleType:r,id:e}:this.isIOS()?{type:c,alternate:null,link:p,os:"ios",roomleType:r,id:e}:{type:c,alternate:null,link:u,os:"desktop",roomleType:r,id:e}}return i===s.BUTTON_TYPE.MARK?this.isAndroid()?null:(this.isIOS(),null):i===s.BUTTON_TYPE.VISUALIZE?this.isAndroid()?{type:c,alternate:null,link:"roomleviewer://item/"+e,os:"android",roomleType:r,id:e}:(this.isIOS(),null):null},t.prototype.handleItem=function(e,t,i){var n=!0;return this.createLinkForItemOrConfiguration(e,t,i,n)},t.prototype.handleConfiguration=function(e,t,i){var n=!1;return this.createLinkForItemOrConfiguration(e,t,i,n)},t.prototype.generateLink=function(e,t,i,n){void 0===n&&(n=null);var r=null;if(t===o.ROOMLE_TYPE.ITEM?r=this.handleItem(e,t,i):t===o.ROOMLE_TYPE.CONFIGURATION||t===o.ROOMLE_TYPE.CONFIGURABLE_ITEM?r=this.handleConfiguration(e,t,i):t===o.ROOMLE_TYPE.PLAN&&(r=this.handlePlan(e,t,i)),!r)return null;var s=r.link.indexOf("?")===-1?"?":"&";return r.link=n?r.link+s+"callback="+n:r.link,r},t.prototype.getLinks=function(e,t,i){var n=this;void 0===i&&(i=null);var r=this.buttonsService.availableButtons,o=[];return r.forEach(function(r){var s=n.generateLink(e,t,r,i);s&&o.push(s)}),o},t}(r.Service);i.MobileDetectService=c},{"../lib/Service":8,"./ButtonsService":10,"./RoomleTypeService":19,"./SettingsService":20}],17:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delay=1200,t.oss={android:{storePrefix:"https://play.google.com/store/apps/details?id="},ios:{storePrefix:"https://itunes.apple.com/app/"}},t}return n(t,e),t.prototype.getTime=function(){return(new Date).getTime()},t.prototype.open=function(e,t,i){return void 0===t&&(t=!1),void 0===i&&(i=null),"function"==typeof i?i(e):void(t?window.open(e):window.location.href=e)},t.prototype.handleAndroidBrowsers=function(e,t,i){var n=navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Mozilla/5.0")>-1&&navigator.userAgent.indexOf("AppleWebKit")>-1,r=new RegExp("AppleWebKit/([d.]+)"),o=r.exec(navigator.userAgent),s=null===o?null:parseFloat(r.exec(navigator.userAgent)[1]),a=n&&null!==s&&s>500;return a?"intent:"+t.split(":")[1]+"#Intent;scheme="+i+";package="+e+";S.browser_fallback_url="+encodeURI(t):t},t.prototype.redirect=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=null),this.perfromDeepLink(e.link,e.os,t,i)},t.prototype.perfromDeepLink=function(e,t,i,n){var r=this;void 0===i&&(i=!1),void 0===n&&(n=null);var o=!1,s=null,a=this.parseHref(e,t),c=a.scheme,l=a.appId,d=this.getTime();o=!0,s=setTimeout(function(){if("desktop"!==t&&o&&s){var n=r.getTime();o=!1,s=null,n-d>=2*r.delay||(l?r.open(r.oss[t].storePrefix+l,i):e&&r.open(e,i))}},this.delay);var u=this.handleAndroidBrowsers(l,e,c);this.open(u,i,n)},t.prototype.parseHref=function(e,t){var i=e.split(":"),n=i[0],r="roomle/id732050356";return"roomleviewer"===n&&(r="com.roomle.viewer","ios"===t&&(r="roomle-viewr/id1053860177")),{appId:r,scheme:n,os:t}},t.prototype.createDeeplinkFor=function(e,t){var i=this,n=e.getAttribute("href"),r=this.parseHref(n,t),o=r.appId;t&&o?e.addEventListener("click",function(e){e.preventDefault(),e.stopImmediatePropagation(),i.perfromDeepLink(n,t)}):n&&"#"!==n||(e.style.display="none")},t}(r.Service);i.MobileRedirectService=o},{"../lib/Service":8}],18:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.fetch=function(e,t){return new Promise(function(i,n){t||(t={});var r=new XMLHttpRequest,o=t.headers;if("GET"===t.method&&t.body){if("object"!=typeof t.body)return void n(new TypeError("Non object like body not allowed for GET requests. The body has to be an object so the properties will be appended as a GET parameter to the url."));var s="",a="";for(var c in t.body)if(t.body.hasOwnProperty(c)){var l=encodeURIComponent(c),d=encodeURIComponent(t.body[c]);a+=""+s+l+"="+d,s="&"}e=e+(e.indexOf("?")===-1?"?":"&")+a}else"string"!=typeof t.body&&(t.body=JSON.stringify(t.body));if("HEAD"===t.method&&t.body)return void n(new TypeError("Body not allowed for HEAD requests"));if(r.onload=function(e){r.status>=400||0===r.status?n(new Error(r.responseText)):i("response"in r?r.response:r.responseText)},r.onerror=function(e){n(e.error)},r.onabort=function(e){n(new TypeError("Network request aborted"))},r.ontimeout=function(e){n(new TypeError("Network request timed out"))},t.credentials&&t.credentials.username?r.open(t.method?t.method:"GET",e,!0,t.credentials.username,t.credentials.password):r.open(t.method?t.method:"GET",e,!0),"object"==typeof o)for(var c in o)o.hasOwnProperty(c)&&r.setRequestHeader(c,o[c]);r.send("undefined"==typeof t.body?null:t.body)})},t.prototype.fetchJSON=function(e,t){return t||(t={}),t.headers||(t.headers={}),t.headers["Content-Type"]||(t.headers["Content-Type"]="application/json"),this.fetch(e,t).then(function(e){return JSON.parse(e)})},t}(r.Service);i.RequestService=o},{"../lib/Service":8}],19:[function(e,t,i){"use strict";var n;!function(e){e[e.ITEM=0]="ITEM",e[e.CONFIGURATION=1]="CONFIGURATION",e[e.PLAN=2]="PLAN",e[e.CONFIGURABLE_ITEM=3]="CONFIGURABLE_ITEM"}(n=i.ROOMLE_TYPE||(i.ROOMLE_TYPE={}));var r=function(){function e(){}return e.convertTypeToEnum=function(e){return"item"===e?n.ITEM:"configuration"===e?n.CONFIGURATION:"plan"===e?n.PLAN:"configurable-item"===e?n.CONFIGURABLE_ITEM:null},e.convertRoomleType=function(e){return e===n.ITEM?"item":e===n.CONFIGURATION?"configuration":e===n.PLAN?"plan":e===n.CONFIGURABLE_ITEM?"configurable-item":null},e}();i.RoomleTypeService=r},{}],20:[function(e,t,i){"use strict";var n=function(){function e(e){this.settings=e}return e.setDefault=function(e,t,i){for(var n=e,r=t.split("."),o=r.length-1,s=0;s<o;s++)n[r[s]]||(n[r[s]]={}),n=n[r[s]];void 0===n[r[o]]&&(n[r[o]]=i)},e.setDeeplinkTranslation=function(t,i,n){e.setDefault(t,"translations."+i+".heading",n.heading),e.setDefault(t,"translations."+i+".hint.ios",n.hint.ios),e.setDefault(t,"translations."+i+".hint.android",n.hint.android),e.setDefault(t,"translations."+i+".hint.desktop",n.hint.desktop),e.setDefault(t,"tracking.enable",!1),e.setDefault(t,"tracking.tenant",9)},e.init=function(t){if(!(this._instance instanceof e)){e.setDefault(t,"web.baseUrl","https://www.roomle.com/app/"),e.setDefault(t,"web.configuratorSameWindow",!1),e.setDefault(t,"viewr.baseUrl","https://www.roomle.com/"),e.setDefault(t,"ios.baseUrl","https://www.roomle.com/"),e.setDefault(t,"dataSelector.type","data-rml-type"),e.setDefault(t,"dataSelector.id","data-rml-id"),e.setDefault(t,"dataSelector.action","data-rml-action"),e.setDefault(t,"planId","8a708083560ca6cf01560cd7361a014a"),e.setDefault(t,"createPopUp",!0),e.setDefault(t,"showBackButton",!0),e.setDefault(t,"html.containerClass","roomle-buttons"),e.setDefault(t,"html.containerType","div"),e.setDefault(t,"html.buttonsContainer","ul"),e.setDefault(t,"html.buttonElement","li"),e.setDefault(t,"css.buttons.position","absolute"),e.setDefault(t,"css.buttons.top","0"),e.setDefault(t,"css.buttons.right","0"),e.setDefault(t,"css.buttons.line-height","normal"),e.setDefault(t,"css.item.position","relative"),e.setDefault(t,"callback",{}),e.setDefault(t,"callback.button",{}),e.setDefault(t,"popUpSelector","data-rml-deeplink-popup-container"),e.setDefault(t,"callback.booted",function(){}),e.setDefault(t,"translations.errors.deeplinkcreate","Error creating deeplink");var i="",n=i+"Enter the following link into the browser of your desktop device",r=i+"Enter the following link into the browser of your iOS device";this.setDeeplinkTranslation(t,"ar",{heading:"Visualize in AR",hint:{ios:r,android:null,desktop:null}}),this.setDeeplinkTranslation(t,"add",{heading:"Add to plan",hint:{ios:null,android:null,desktop:n}}),this.setDeeplinkTranslation(t,"configure",{heading:"Customize",hint:{ios:null,android:null,desktop:n}}),this.setDeeplinkTranslation(t,"mark",{heading:"Favourite",hint:{ios:null,android:null,desktop:null}}),this.setDeeplinkTranslation(t,"trigger",{heading:"Trigger",hint:{ios:null,android:null,desktop:null}}),this.setDeeplinkTranslation(t,"visualize",{heading:"Visualize",hint:{ios:null,android:n,desktop:null}}),this.setDeeplinkTranslation(t,"vr",{heading:"View in VR",hint:{ios:r,android:"",desktop:""}}),this.setDeeplinkTranslation(t,"start_now",{heading:"Start planning now",hint:{ios:r,android:"",desktop:""}}),this._instance=new this(t)}return this._instance},e.getInstance=function(){return this._instance},Object.defineProperty(e,"settings",{get:function(){return e.getInstance().settings},enumerable:!0,configurable:!0}),e}();i.SettingsService=n},{}],21:[function(e,t,i){"use strict";var n=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=e("../lib/Service"),o=e("./SettingsService"),s=e("../config/Environment"),a="rml-tracking-iframe",c=function(e){function t(){var t=e.call(this)||this;if(t.isGAInitialized=!1,t.gaProvider=null,o.SettingsService.settings.tracking.enable&&!o.SettingsService.settings.tracking.gaProvider){var i=document.createElement("iframe");i.setAttribute("src",s.Environment.settings().gaUrl),i.setAttribute("id",a),i.setAttribute("style","visibility:hidden!important;display:none;width:0;height:0;"),i.height="0",i.width="0",document.body.appendChild(i)}return t}return n(t,e),t.toLabel=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),e+(t?"#"+t:"")+(i?"#"+i:"")},t.prototype.getUid=function(){if(window.location.href.indexOf("roomle.com")===-1)return null;if(!window.localStorage)return null;var e=window.localStorage.getItem("ember_simple_auth:session");try{if(e){var t=JSON.parse(e);if(t.authenticated&&t.authenticated.auth)return t.authenticated.auth.userId}return null}catch(i){return null}},t.prototype.getGAProvider=function(){var e=this;if(this.gaProvider)return this.gaProvider;var t=null;if(o.SettingsService.settings.tracking.gaProvider)t={ga:o.SettingsService.settings.tracking.gaProvider,gaSetUid:function(){var t=e.getUid();t&&o.SettingsService.settings.tracking.gaProvider("set","&uid",t)},gaSetTenant:function(e){o.SettingsService.settings.tracking.gaProvider("set","dimension1",e)}};else{var i=document.getElementById(a);if(!i)return null;var n=i.contentWindow;if(!n)return null;var r=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=["MessageFromRoomle."+e];n.push.apply(n,t),document.getElementById(a).contentWindow.postMessage(JSON.stringify(n),"*")};t={ga:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.apply(void 0,["ga"].concat(e))},gaSetUid:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.apply(void 0,["gaSetUid"].concat(e))},gaSetTenant:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.apply(void 0,["gaSetTenant"].concat(e))}}}return this.gaProvider=t,t},t.prototype.initGA=function(e){this.isGAInitialized=!0,e.gaSetUid(),e.gaSetTenant(o.SettingsService.settings.tracking.tenant)},t.prototype.trackGA=function(e,i,n){var r=t.GA_CATEGROY,s=o.SettingsService.settings.tracking.enable,a=this.getGAProvider();if(s&&a){var c={};return r&&(c.eventCategory=r),e&&(c.eventAction=e),i&&(c.eventLabel=i),"number"==typeof n&&(c.eventValue=n),c.hitType="event",this.isGAInitialized||this.initGA(a),a.ga("send",c)}},t.prototype.trackGAInteraction=function(e,i,n,r){":"===e.substr(-1)?(this.trackGA(e,t.toLabel(i,n),r||1),this.trackGA("Interaction:",t.toLabel(i,n,e.slice(0,-1)),r||1)):this.trackGA(e,n,r)},t}(r.Service);c.GA_CATEGROY="RoomleButton",i.TrackingService=c},{"../config/Environment":2,"../lib/Service":8,"./SettingsService":20}],22:[function(e,t,i){"use strict";var n=function(){function e(){}return e.getNamesAndValues=function(e){return this.getNames(e).map(function(t){return{name:t,value:e[t]}})},e.getNames=function(e){return this.getObjValues(e).filter(function(e){return"string"==typeof e})},e.getValues=function(e){return this.getObjValues(e).filter(function(e){return"number"==typeof e})},e.getObjValues=function(e){return Object.keys(e).map(function(t){return e[t]})},e}();i.EnumEx=n},{}]},{},[9]);
//# sourceMappingURL=roomle-button.min.js.map
